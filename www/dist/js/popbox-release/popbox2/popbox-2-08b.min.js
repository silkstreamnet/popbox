!function(a){function b(a,b){return void 0!==a?a:b}function c(a,c){return c=b(c,!1),!isNaN(a-0)&&null!=a&&""!=a&&(!c||a>0)}function d(a,c){return c=b(c,!1),"string"==typeof a&&null!=a&&(!c||""!=a)}function e(b,c){if(b.properties.animating)switch(b.properties.animating=!1,c){case"close":b.container.remove(),b.container=!1,b.properties.isopen=!1,b.popup=!1,b.shadow=!1,a("body").css({overflow:b.properties.bodyOverflow,"margin-right":b.properties.bodyMarginRight}),a(document).off("scroll.popbox touchmove.popbox mousewheel.popbox");break;case"open":b.properties.isopen=!0}}function f(a,c){a=b(a,!1),c=b(c,!1);var d=!0;if(a&&a.popup){var e=a.popup.find("img");e.length>0&&e.each(function(a,b){b.complete||4===b.readyState||"complete"===b.readyState||(d=!1)})}return"gallery"==a.settings.mode&&(d?(a.content_area.css({visibility:"",height:"",overflow:""}),a.gallery_loading&&a.gallery_loading.hide()):(a.content_area.css({visibility:"hidden",height:"0",overflow:"hidden"}),a.gallery_loading&&a.gallery_loading.show())),d&&c&&k(a),d}function g(a){if((a=b(a,!1))&&a.popup){var c=a.popup.find("img");if(c.length>0){var d=0;c.each(function(b,c){c.complete||4===c.readyState||"complete"===c.readyState?d++:void 0!==c.onload?c.onload=function(){void 0!==c.readyState?setTimeout(function(){f(a,!0)},10):f(a,!0)}:void 0!==c.onreadystatechange&&(c.onreadystatechange=function(){setTimeout(function(){f(a,!0)},10)})}),c.length==d&&f(a,!0)}}}function h(a){a.properties.loaded_content!==a.settings.content&&(f(a)||g(a),a.properties.loaded_content=a.settings.content)}function i(b){var c=a("body"),d=b.container.clone().stop(!0,!0).addClass("popbox-rsc-clone").css({display:"block",visibility:"hidden","z-index":"-1",overflow:"hidden"});d.find("iframe").attr("src",""),d.appendTo(c);var e=c.find(".popbox-rsc-clone");return{container:e,popup:e.find(".popbox-popup").eq(0),content:e.find(".popbox-content").eq(0)}}function j(a){a&&a.container&&a.container.remove()}function k(a,d){if(d=b(d,!1),(a=b(a,!1))&&a.popup){var e=a.settings,f=a.popup,g=a.container,h=a.content_area;f.stop(!0,!1);var k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=g.outerWidth(!1),t=g.outerHeight(!1),u=0,v=0,w=0,x=!1,y=!1;if(e.autoScale){if(y=i(a),y.popup.css({height:"auto",width:"auto",top:"auto",left:"auto"}),y.content.attr("style",""),y.content.find("img").css({"max-width":"none",height:"auto",display:"block"}),y.content.find("iframe").css({"max-height":"none","max-width":"none"}),o=y.popup.width(),p=y.popup.height(),q=y.popup.outerWidth(!1)-o,r=y.popup.outerHeight(!1)-p,j(y),u=.8*s-q,v=.8*t-r,p>v||o>u){var z=v/u,A=p/o,B=1;A>z?(B=v/p,l=v,k=o*B):(B=u/o,k=u,l=p*B)}else k=o,l=p;f.find("img").css({"max-width":"100%",height:"auto",display:"block"}),f.find("iframe").css({"max-height":"100%","max-width":"100%"})}else{u=.8*s,v=.8*t,q=f.outerWidth(!1)-f.width(),r=f.outerHeight(!1)-f.height(),k=u-q,l=v-r,c(e.width)?k=e.width:c(e.maxwidth)&&k>e.maxwidth&&(k=e.maxwidth),y=i(a),y.popup.css({height:"auto",width:k,top:"0",left:"0"}),y.content.attr("style",""),c(e.height)?l=e.height:c(e.maxheight)&&l>e.maxheight?l=e.maxheight:e.innerOverflow||(l=y.popup.height()),0==parseInt(y.content.css("margin-top"))&&y.content.css({"margin-top":"-1px",top:"1px"});var C=y.content.outerHeight(!0),D=C-y.content.height(),E=parseInt(y.popup.css("padding-top")),F=parseInt(y.popup.css("border-top-width")),G=parseInt(y.popup.css("margin-top"));isNaN(E)&&(E=0),isNaN(F)&&(F=0),isNaN(G)&&(G=0);var H=E+F+G,I=l-(y.content.position().top-H);!0===d&&e.animateSpeed>0?h.stop(!0,!1).height(h.height()).animate({height:I-D},e.animateSpeed):h.css({height:I-D}),C>I&&e.innerOverflow&&h.css("overflow-y","scroll"),j(y),w=.05*t,v=.9*t,n=l+r,n>v?(x=w,g.css("overflow","auto"),a.bottom_push.css({top:w+n+"px",height:w+"px",width:"1px"}),a.shadow.css({height:2*w+n+"px"})):(g.css("overflow",""),a.bottom_push.css({top:"0px",height:"0px",width:"0px"}),a.shadow.css({height:"100%"}))}m=k+q,n=l+r;var J=(s-m)/2,K=(t-n)/2;!1!==x&&(K=x),!0===d&&e.animateSpeed>0?f.animate({left:J,top:K,width:k,height:l},e.animateSpeed).css("overflow",""):f.css({left:J,top:K,width:k,height:l})}}var l=function(c){c=b(c,{}),"gallery"==c.mode&&null==c.autoScale&&(c.autoScale=!0),this.settings=a.extend({},this.defaultSettings,c),this.container=!1,this.popup=!1,this.shadow=!1,this.properties={animating:!1,isopen:!1,resizepause:!1,loaded_content:-1,bodyMarginRight:"",bodyOverflow:""}};l.prototype.adjust=function(a){a=b(a,!1);var c=this;c.properties.resizepause||a&&!c.properties.isopen||(c.properties.resizepause=!0,setTimeout(function(){k(c,a),c.properties.resizepause=!1},c.properties.updatePositionDelay),h(c))},l.prototype.checkImages=function(){this.properties.loaded_content=-1},l.prototype.close=function(){var b=this;!b.properties.animating&&b.properties.isopen&&("function"==typeof b.settings.onClose&&b.settings.onClose(b),b.properties.animating=!0,b.container.fadeOut(b.settings.fadeOutSpeed,function(){e(b,"close")}),a(window).off("resize.popbox.adjust"),b.properties.isopen=!1,b.checkImages(),"function"==typeof b.settings.afterClose&&b.settings.afterClose(b))},l.prototype.open=function(){var b=this;if(!b.properties.animating&&!b.properties.isopen){"function"==typeof b.settings.onOpen&&b.settings.onOpen(b),b.properties.animating=!0;var c=d(this.settings.close,!0)?b.settings.close:b.defaultSettings.close,f=d(this.settings.content,!0)?b.settings.content:"",g=d(this.settings.title,!0)?'<div class="popbox-title">'+b.settings.title+"</div>":"",h=d(this.settings.customClass,!0)?" "+b.settings.customClass:"",i=a("body");b.properties.bodyOverflow=i.css("overflow");var j=i.width();i.css("overflow","hidden");var k=i.width();if(k>j){b.properties.bodyMarginRight=i.css("margin-right");var l=parseInt(b.properties.bodyMarginRight),m=l+(k-j);i.css("margin-right",m+"px")}if(a(document).on("scroll.popbox touchmove.popbox mousewheel.popbox",function(a){}),i.append('<div class="popbox-container'+h+'" style="display: none;"><div class="popbox-bottom-push"></div><a class="popbox-shadow" href="javascript:void(0);"></a><div class="popbox-popup">'+g+'<a class="popbox-close">'+c+'</a><div class="popbox-content">'+f+"</div></div></div>"),b.container=a(".popbox-container"),b.popup=b.container.find(".popbox-popup"),b.shadow=b.container.find(".popbox-shadow"),b.bottom_push=b.container.find(".popbox-bottom-push"),b.close_button=b.container.find(".popbox-close"),b.title_area=b.container.find(".popbox-title"),b.content_area=b.container.find(".popbox-content"),"gallery"==b.settings.mode){b.content_area.css({visibility:"hidden",height:"0"});var n=d(this.settings.gallery.loading,!0)?b.settings.gallery.loading:b.defaultSettings.gallery.loading;b.content_area.after('<div class="popbox-gallery-loading">'+n+"</div>"),b.gallery_loading=b.container.find(".popbox-gallery-loading")}b.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)"}),b.bottom_push.css({display:"block",position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"}),b.popup.css({display:"block",position:"absolute",top:"0px",left:"0px","z-index":"993"}),b.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991",background:"#fff",opacity:"0",cursor:"default"}),b.content_area.css({overflow:"hidden",height:"100%"}),b.adjust(),b.container.fadeIn(b.settings.fadeInSpeed,function(){e(b,"open")}),b.shadow.click(function(a){b.close(),a.preventDefault()}),b.close_button.click(function(a){b.close(),a.preventDefault()}),a(window).on("resize.popbox.adjust",function(){b.adjust(!0)}),b.properties.isopen=!0,"function"==typeof b.settings.afterOpen&&b.settings.afterOpen(b)}},l.prototype.update=function(c,e){var f=this;if(c=b(c,{}),e=b(e,!0),f.settings=a.extend({},f.settings,c),f.properties.isopen){var g=d(f.settings.close,!0)?f.settings.close:f.defaultSettings.close,h=d(f.settings.content,!0)?f.settings.content:"",i=d(f.settings.title,!0)?f.settings.title:"";f.close_button.length>0&&f.close_button.html(g),f.content_area.length>0&&f.content_area.html(h),f.title_area.length>0?""!=i?f.title_area.html(i):(f.title_area.remove(),f.title_area=f.popup.find(".popbox-title")):""!=i&&(f.popup.prepend('<div class="popbox-title">'+i+"</div>"),f.title_area=f.popup.find(".popbox-title")),e&&f.adjust(!0)}},l.prototype.isOpen=function(){return 1==this.properties.isopen},l.prototype.isClose=function(){return 0==this.properties.isopen},l.prototype.defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",innerOverflow:!1,content:"",close:"X",title:"",onOpen:!1,onClose:!1,afterOpen:!1,afterClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200,autoScale:!1,customClass:"",animateSpeed:400,mode:"normal",gallery:{loading:"Loading"}},window.PopBox=l}(jQuery);