!function(a){function b(a,b){return void 0!==a?a:b}function c(a,c){return c=b(c,!1),!isNaN(a-0)&&null!=a&&""!=a&&(!c||a>0)}function d(a,c){return c=b(c,!1),"string"==typeof a&&null!=a&&(!c||""!=a)}function e(a,b){if(a.properties.animating)switch(a.properties.animating=!1,b){case"close":a.container.remove(),a.properties.isopen=!1,a.container=!1,a.popup=!1,a.shadow=!1;break;case"open":a.properties.isopen=!0}}function f(b,d){var e={forceAbsolute:!1,container:window,completeHandler:null,animate:!0,width:"auto",height:"auto",maxwidth:"none",maxheight:"none",push_obj:!1,shadow:!1,autoScale:!1,innerOverflow:!1};a.extend(e,d),b.each(function(d){var f=a(this),g=a(e.container),h=e.container==window;e.forceAbsolute&&(h?f.remove().appendTo("body"):f.remove().appendTo(g.get(0)));var i={position:f.css("position"),visibility:f.css("visibility"),display:f.css("display")},j={visibility:g.css("visibility"),display:g.css("display")},k={position:"absolute",visibility:"hidden",display:"block"},l={visibility:"hidden",display:"block"};f.css(k),h||g.css(l);var m,n,o,p,q,r=!1;if(e.autoScale){f.css({height:"",width:""}),m=.8*(h?g.width():g.outerWidth(!1)),n=.8*(h?g.height():g.outerHeight(!1));var s=f.outerWidth(!1),t=f.outerHeight(!1);if(o=f.width(),p=f.height(),m-=s-o,n-=t-p,p>n||o>m){var u=n/m,v=p/o,w=1;v>u?(w=n/p,f.height(n),f.width(o*w)):(w=m/o,f.width(m),f.height(p*w))}else f.width(o),f.height(p);f.find("img").css({"max-width":"100%",height:"auto",display:"block"}),f.find("iframe").css({"max-height":"100%","max-width":"100%"})}else{m=.8*(h?g.width():g.outerWidth(!1)),n=.8*(h?g.height():g.outerHeight(!1));var x=f.outerWidth(!1)-f.width(),y=f.outerHeight(!1)-f.height(),z=m-x,A=n-y;if(c(e.width)?f.width(e.width):c(e.maxwidth)&&z>e.maxwidth?f.width(e.maxwidth):f.width(z),c(e.height))f.height(e.height);else if(e.innerOverflow||c(e.maxheight)){c(e.maxheight)&&A>e.maxheight?f.height(e.maxheight):f.height(A);var B=f.find(".popbox-content");if(1==B.length){B.css({"overflow-y":"",height:"",position:"relative"}),0==parseInt(B.css("margin-top"))&&B.css({"margin-top":"-1px",top:"1px"});var C=B.outerHeight(!0),D=C-B.height(),E=parseInt(f.css("padding-top"))+parseInt(f.css("border-top-width"))+parseInt(f.css("margin-top")),F=f.height()-(B.position().top-E);C>F&&(B.css("overflow-y","scroll"),B.height(F-D))}}q=.05*(h?g.height():g.outerHeight(!1));n=.9*(h?g.height():g.outerHeight(!1)),p=f.outerHeight(!1),p>n?(r=q,g.css("overflow","auto"),e.push_obj.css({top:q+p+"px",height:q+"px",width:"1px"}),e.shadow.css({height:2*q+p+"px"})):(g.css("overflow",""),e.push_obj.css({top:"0px",height:"0px",width:"0px"}),e.shadow.css({height:"100%"}))}var G=((h?g.width():g.outerWidth(!1))-f.outerWidth(!1))/2,H=((h?g.height():g.outerHeight(!1))-f.outerHeight(!1))/2;!1!==r&&(H=r),h&&(G+=g.scrollLeft(),H+=g.scrollTop()),f.css(i),h||g.css(j),!0===e.animate?f.stop(!0,!0).animate({left:G,top:H},500):f.stop(!0,!0).css({left:G,top:H}),e.completeHandler&&e.completeHandler(b)})}function g(a,c){a=b(a,!1),c=b(c,!1);var d=!0;if(a&&a.popup){var e=a.popup.find("img");e.length>0&&e.each(function(a,b){b.complete||(d=!1)})}return c&&d&&j(a,!0),d}function h(c){if((c=b(c,!1))&&c.popup){var d=c.popup.find("img");if(d.length>0){var e=0;d.each(function(b,d){d.complete?e++:a(d).load(function(){g(c,!0)})}),d.length==e&&g(c,!0)}}}function i(a){a.properties.loaded_content!==a.settings.content&&(g(a)||h(a),a.properties.loaded_content=a.settings.content)}function j(a,c){c=b(c,!1),(a=b(a,!1))&&f(a.popup,{animate:c,container:a.container,width:a.settings.width,height:a.settings.height,maxwidth:a.settings.maxwidth,maxheight:a.settings.maxheight,push_obj:a.bottom_push,shadow:a.shadow,autoScale:a.settings.autoScale,innerOverflow:a.settings.innerOverflow})}var k=function(c){c=b(c,{}),this.settings=a.extend({},this.defaultSettings,c),this.container=!1,this.shadow=!1,this.properties={animating:!1,isopen:!1,resizepause:!1,loaded_content:-1}};k.prototype.adjust=function(a){a=b(a,!1);var c=this;c.properties.resizepause||a&&!c.properties.isopen||(c.properties.resizepause=!0,setTimeout(function(){j(c,a),c.properties.resizepause=!1},c.properties.updatePositionDelay),i(c))},k.prototype.checkImages=function(){this.properties.loaded_content=-1},k.prototype.close=function(){var b=this;!b.properties.animating&&b.properties.isopen&&("function"==typeof b.settings.beforeClose&&b.settings.beforeClose(b),b.properties.animating=!0,b.container.fadeOut(b.settings.fadeOutSpeed,function(){e(b,"close"),a("body").css({overflow:"","margin-right":""})}),a(window).off("resize.popbox.adjust"),b.properties.isopen=!1,b.checkImages(),"function"==typeof b.settings.onClose&&b.settings.onClose(b))},k.prototype.open=function(){var b=this;if(!b.properties.animating&&!b.properties.isopen){"function"==typeof b.settings.beforeOpen&&b.settings.beforeOpen(b),b.properties.animating=!0;var c=d(this.settings.close,!0)?b.settings.close:this.defaultSettings.close,f=d(this.settings.content,!0)?b.settings.content:"",g=d(this.settings.title,!0)?'<div class="popbox-title">'+b.settings.title+"</div>":"",h=d(this.settings.class,!0)?" "+b.settings.class:"",i=a("body"),j=i.width();i.css("overflow","hidden");var k=i.width();if(k>j){var l=parseInt(i.css("margin-right")),m=l+(k-j);i.css("margin-right",m+"px")}i.append('<div class="popbox-container'+h+'" style="display: none;"><div class="popbox-bottom-push"></div><a class="popbox-shadow" href="javascript:void(0);"></a><div class="popbox-popup">'+g+'<a class="popbox-close">'+c+'</a><div class="popbox-content">'+f+"</div></div></div>"),b.container=a(".popbox-container"),b.popup=b.container.find(".popbox-popup"),b.shadow=b.container.find(".popbox-shadow"),b.bottom_push=b.container.find(".popbox-bottom-push"),b.close_button=b.container.find(".popbox-close"),b.title_area=b.container.find(".popbox-title"),b.content_area=b.container.find(".popbox-content"),b.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)"}),b.bottom_push.css({display:"block",position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"}),b.popup.css({display:"block",visibility:"visible",position:"absolute",top:"0px",left:"0px","z-index":"993"}),b.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991",background:"#fff",opacity:"0",filter:"alpha(opacity=0)",cursor:"default"}),b.adjust(),b.container.fadeIn(b.settings.fadeInSpeed,function(){e(b,"open")}),b.shadow.click(function(a){b.close(),a.preventDefault()}),b.close_button.click(function(a){b.close(),a.preventDefault()}),a(window).on("resize.popbox.adjust",function(){b.adjust(!0)}),b.properties.isopen=!0,"function"==typeof b.settings.onOpen&&b.settings.onOpen(b)}},k.prototype.update=function(c,e){var f=this;if(c=b(c,{}),e=b(e,!0),f.settings=a.extend({},f.settings,c),f.properties.isopen){var g=d(f.settings.close,!0)?f.settings.close:this.defaultSettings.close,h=d(f.settings.content,!0)?f.settings.content:"",i=d(f.settings.title,!0)?f.settings.title:"";f.close_button.length>0&&f.close_button.html(g),f.content_area.length>0&&f.content_area.html(h),f.title_area.length>0?""!=i?f.title_area.html(i):(f.title_area.remove(),f.title_area=f.popup.find(".popbox-title")):""!=i&&(f.popup.prepend('<div class="popbox-title">'+i+"</div>"),f.title_area=f.popup.find(".popbox-title")),e&&f.adjust(!0)}},k.prototype.isOpen=function(){return 1==this.properties.isopen},k.prototype.isClose=function(){return 0==this.properties.isopen},k.prototype.defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",innerOverflow:!1,content:"",close:"X",title:"",onOpen:!1,onClose:!1,beforeOpen:!1,beforeClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200,autoScale:!1,class:""},window.PopBox=k}(jQuery);