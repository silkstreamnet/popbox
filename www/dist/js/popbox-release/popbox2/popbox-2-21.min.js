!function(a){function b(a,b){return void 0!==a?a:b}function c(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function d(a,c){return c=b(c,!1),!isNaN(a-0)&&null!=a&&""!=a&&(!c||a>0)}function e(a,c){return c=b(c,!1),"string"==typeof a&&null!=a&&(!c||""!=a)}function f(a,b){var c=a.attr(b);return void 0!==c&&!1!==c&&""!==c||(c=""),c}function g(a,c,d,e){e=b(e,"");for(var f in c)if(c.hasOwnProperty(f))if("object"==typeof c[f])d[f]={},g(a,c[f],d[f],e+f.toLowerCase()+"-");else{var h=a.data(e+f.toLowerCase());if(void 0!==h){var i=parseFloat(h);"true"==h?h=!0:"false"==h?h=!1:i==h&&(h=i),d[f]=h}}}function h(a,b,c){if(c=c||!1,b instanceof Array)for(var d=0;d<b.length;d++)if(c){if(b[d]===a)return d}else if(b[d]==a)return d;return-1}function i(a,b){var d=f(a,"style");if(b&&d){var e=new RegExp("(^|;)\\s*"+c(b)+"\\s*:");if(d.match(e))return a.css(b)}return""}function j(a,b){if(a._properties.animating)switch(a._properties.animating=!1,b){case"close":a.container.remove(),a.container=!1,a._properties.isopen=!1,a.popup=!1,a.shadow=!1,a.$html.css({overflow:a._properties.stored_styles.htmlOverflow,height:a._properties.stored_styles.htmlHeight,"margin-right":a._properties.stored_styles.htmlMarginRight});break;case"open":a._properties.isopen=!0}}function k(a){var b=a.popup.find("img"),c=a.popup.find("iframe");b.css({"max-width":"100%",height:"auto"}),c.css({"max-height":"100%","max-width":"100%"}),a._settings.autoScale&&(b.filter(":visible").css({display:"block"}),c.css({display:"block"}))}function l(a){(a=b(a,!1))&&a.popup&&a.update({content:'<img src="'+a._properties.gallery.images[a._properties.gallery.position]+'" style="display:none;" />'})}function m(a){(a=b(a,!1))&&a.popup&&(a.gallery_next&&a.gallery_next.remove(),a.gallery_prev&&a.gallery_prev.remove(),a.gallery_next=!1,a.gallery_prev=!1)}function n(a){if((a=b(a,!1))&&a.popup&&a._properties.gallery.images.length>1){a.popup.append('<a href="#" class="popbox-gallery-next">&nbsp;'+a._settings.gallery.next+"</a>"),a.gallery_next=a.popup.find(".popbox-gallery-next"),a.popup.append('<a href="#" class="popbox-gallery-prev">'+a._settings.gallery.prev+"&nbsp;</a>"),a.gallery_prev=a.popup.find(".popbox-gallery-prev");var c=!1,d=!1;a.gallery_next.click(function(b){b.preventDefault(),a._properties.gallery.position++,a._properties.gallery.position>=a._properties.gallery.images.length&&(a._properties.gallery.position=0),l(a)}).mousemove(function(b){c||(a.gallery_next.addClass("popbox-btn-hover"),c=!0,setTimeout(function(){c=!1},200))}).mouseleave(function(b){a.gallery_next.removeClass("popbox-btn-hover")}),a.gallery_prev.click(function(b){b.preventDefault(),a._properties.gallery.position--,a._properties.gallery.position<0&&(a._properties.gallery.position=a._properties.gallery.images.length-1),l(a)}).mousemove(function(b){d||(a.gallery_prev.addClass("popbox-btn-hover"),d=!0,setTimeout(function(){d=!1},200))}).mouseleave(function(b){a.gallery_prev.removeClass("popbox-btn-hover")})}}function o(b){var c=!1;return b.content.find("img").each(function(){var b=a(this);0!=b.width()&&0!=b.height()||!1!==this.complete||(c=!0)}),c}function p(a){var b="popbox-rsc-clone-"+(new Date).getTime(),c=a.container.clone().stop(!0,!0).addClass(b).css({display:"block",visibility:"hidden","z-index":"-1",overflow:"hidden"});c.find("iframe").attr("src",""),c.appendTo(a.$body);var d=a.$body.find("."+b);return{container:d,popup:d.find(".popbox-popup").eq(0),content:d.find(".popbox-content").eq(0),gallery_loading_area:d.find(".popbox-gallery-loading").eq(0)}}function q(a){a&&a.container&&a.container.remove()}function r(a,c){switch(c=b(c,"fixed")){case"fixed":a.container.css({position:"fixed",top:"0"});break;case"absolute":a.container.css({position:"absolute",top:a.container.offset().top})}}function s(a){(a=b(a,!1))&&a.popup&&("gallery"==a._settings.mode&&"ready"==a._properties.gallery.status&&a.content_area.find("img:hidden").fadeIn(300),a.popup.find(".popbox-btn-hover").removeClass("popbox-btn-hover"),a.$window.trigger("scroll.popbox"))}function t(a){a=b(a,!1);var c=!0;if(a&&a.popup){var e=a._settings,f=a.popup,g=a.container,h=a.content_area,i=a.shadow,j=a.gallery_loading_area;f.stop(!0,!1),g.css("overflow-y","hidden"),k(a);var l=0,m=0,n=0,r=0,t=0,u=0,v=0,w=0,x=i.width(),y=g.outerHeight(!1),z=0,A=0,B=0,C=!1,D=!1;if(!e.autoScale||"gallery"==a._settings.mode&&"ready"!=a._properties.gallery.status){z=.8*x,A=.8*y,v=f.outerWidth(!1)-f.width(),w=f.outerHeight(!1)-f.height(),l=z-v,m=A-w,D=p(a),D.popup.css({height:"auto",width:"auto",top:"0",left:"0"}),D.content.attr("style",""),D.gallery_loading_area.attr("style","");var E=h,F=D.content;"gallery"!=a._settings.mode||"ready"==a._properties.gallery.status?(D.content.css("display","block"),D.gallery_loading_area.css("display","none")):(D.content.css("display","none"),D.gallery_loading_area.css("display","block"),E=j,F=D.gallery_loading_area),d(e.width)?l=e.width:(e.scaleToContent||"ready"!=a._properties.gallery.status)&&D.popup.width()<l&&(l=D.popup.width()),d(e.maxwidth)&&l>e.maxwidth&&(l=e.maxwidth),D.popup.css({width:l}),d(e.height)?m=e.height:e.innerOverflow||(m=D.popup.height()),d(e.maxheight)&&m>e.maxheight&&(m=e.maxheight),0==parseInt(F.css("margin-top"))&&F.css({"margin-top":"-1px",top:"1px"}),o(D)&&(c=!1);var G=F.outerHeight(!0),H=G-F.height(),I=parseInt(D.popup.css("padding-top")),J=parseInt(D.popup.css("border-top-width")),K=parseInt(D.popup.css("margin-top"));isNaN(I)&&(I=0),isNaN(J)&&(J=0),isNaN(K)&&(K=0);var L=I+J+K,M=m-(F.position().top-L);!a._properties.newopen&&e.animateSpeed>0?E.stop(!0,!1).height(E.height()).animate({height:M-H},e.animateSpeed):E.stop(!0,!1).css({height:M-H}),G>M&&e.innerOverflow&&E.css("overflow-y","scroll"),q(D),B=.05*y,A=.9*y,r=m+w,r>A?(C=B,g.css("overflow-y","scroll"),a.bottom_push.css({top:B+r+"px",height:B+"px",width:"1px"}),a.shadow.css({height:2*B+r+"px"})):(a.bottom_push.css({top:"0px",height:"0px",width:"0px"}),a.shadow.css({height:"100%"}))}else{if(h.css({height:"100%",width:"100%",overflow:"hidden"}),D=p(a),D.popup.css({height:"auto",width:"auto",top:"auto",left:"auto"}),D.content.attr("style",""),D.content.find("img").css({"max-width":"none",height:"auto",display:"block"}),D.content.find("iframe").css({"max-height":"none","max-width":"none"}),o(D))return!1;if(t=D.popup.width(),u=D.popup.height(),v=D.popup.outerWidth(!1)-t,w=D.popup.outerHeight(!1)-u,q(D),z=.8*x-v,A=.8*y-w,z>e.maxwidth&&(z=e.maxwidth),A>e.maxheight&&(A=e.maxheight),u>A||t>z){var N=A/z,O=u/t,P=1;O>N?(P=A/u,m=A,l=t*P):(P=z/t,l=z,m=u*P)}else l=t,m=u}n=l+v,r=m+w;var Q=(x-n)/2,R=(y-r)/2;!1!==C&&(R=C),!a._properties.newopen&&e.animateSpeed>0?f.animate({left:Q,top:R,width:l,height:m},e.animateSpeed,function(){s(a)}).css("overflow",""):(f.css({left:Q,top:R,width:l,height:m}),s(a))}return c}function u(a){a.content_area.show(),a.gallery_loading_area.hide(),a._properties.gallery.status="ready"}function v(a){if("gallery"==a._settings.mode){var b=e(a._settings.gallery.loading,!0)?a._settings.gallery.loading:a._defaultSettings.gallery.loading;a.content_area.hide(),a.gallery_loading_area.show(),a.gallery_loading_area.html(b),a._properties.gallery.status="loading"}}function w(a){if("gallery"==a._settings.mode){var b=e(a._settings.gallery.error,!0)?a._settings.gallery.error:a._defaultSettings.gallery.error;a.content_area.hide(),a.gallery_loading_area.show(),a.gallery_loading_area.html(b),a._properties.gallery.status="error",a.adjust(!0)}}function x(a){a=b(a,!1);var c=!0;if(a&&a.popup){var d=a._properties.loaded_images;if(d.length)for(var e=0;e<d.length;e++){var f=d[e];f.complete||4===f.readyState||"complete"===f.readyState||(c=!1)}}return c&&u(a),c}function y(c){if((c=b(c,!1))&&c.popup){c._properties.loaded_images=[];var d=c.content_area.find("img");if(!(d.length>0))return!0;v(c);var e=0;if(d.each(function(b,d){if(d.src){var f=new Image;d.complete||4===d.readyState||"complete"===d.readyState?e++:(void 0!==f.onload?f.onload=function(){setTimeout(function(){x(c)&&c.adjust(!0)},10)}:void 0!==f.onreadystatechange&&(f.onreadystatechange=function(){setTimeout(function(){x(c)&&c.adjust(!0)},10)}),void 0!==f.onerror&&(f.onerror=function(){setTimeout(function(){a(d).remove(),w(c)},10)})),f.src=d.src,c._properties.loaded_images.push(f)}}),d.length==e)return!0}return!1}function z(a){var b=!1;return a._properties.loaded_content!==a._settings.content&&(b=y(a),a._properties.loaded_content=a._settings.content),b}function A(b){if(B(b),"gallery"==b._settings.mode&&(b._settings.autoScale=!0),b.content_area.find("img").hide(),b.shadow.css({height:"100%"}),b.container.scrollTop(0),b._settings.gallery.name){var c=a("."+b._settings.gallery.name);if(c.length&&(c.each(function(){var c=a(this);if(0==c.closest(".popbox-container").length){var d=f(c,"src"),e=f(c,"href"),g=d||e;g&&-1==h(g,b._properties.gallery.images)&&b._properties.gallery.images.push(g)}}),b._properties.gallery.images.length>0)){var d="",e=b.content_area.find("img:first");e.length&&(d=f(e.eq(0),"src"));var g=h(d,b._properties.gallery.images);b._properties.gallery.position=0,""==d||-1==g?b._properties.gallery.images.unshift(d):g>-1&&(b._properties.gallery.position=g),n(b)}}}function B(a){a.content_area.show(),a.gallery_loading_area.hide(),a._properties.gallery.status="ready",a._properties.gallery.images=[],a._properties.gallery.position=0,m(a)}var C=function(c){c=b(c,{}),this.$window=a(window),this.$html=a("html"),this.$body=a("body"),this._settings=a.extend(!0,{},this._defaultSettings,c),this.container=!1,this.popup=!1,this.shadow=!1,this._properties={animating:!1,isopen:!1,newopen:!0,newopentime:0,retrytime:0,resizepause:!1,loaded_content:-1,loaded_images:[],stored_styles:{htmlOverflow:"",htmlHeight:"",htmlMarginRight:""},gallery:{status:"ready",images:[],position:0}}};C.prototype.adjust=function(a){a=b(a,!1);var c=this;if(c._properties.isopen&&(a||!c._properties.resizepause))if(z(c)&&u(c),c._properties.newopen)t(c),c._properties.newopen=!1;else{var e=1,f="normal";"gallery"==c._settings.mode&&"loading"==c._properties.gallery.status?(e=100,f="loading"):d(a,!0)?e=a:a||(e=c._settings.updatePositionDelay),c._properties.resizepause=!0,c._properties.resizetimer=setTimeout(function(){if("normal"==f||"loading"==f&&"error"!=c._properties.gallery.status)if(t(c))c._properties.retrytime=0;else if(c._properties.retrytime>=3e3)c._properties.retrytime=0;else{c.adjust(100),c._properties.retrytime+=100}c._properties.resizepause=!1,c._properties.resizetimer=!1},e)}},C.prototype.refresh=function(){this._properties.loaded_content=-1,this._properties.loaded_images=[]},C.prototype.close=function(){var a=this;!a._properties.animating&&a._properties.isopen&&("function"==typeof a._settings.onClose&&a._settings.onClose(a),a._properties.animating=!0,a.container.fadeOut(a._settings.fadeOutSpeed,function(){j(a,"close")}),a.$window.off("resize.popbox scroll.popbox mousewheel.popbox"),a._properties.isopen=!1,a.refresh(),"gallery"==a._settings.mode&&a.update({content:""},!1),"function"==typeof a._settings.afterClose&&a._settings.afterClose(a))},C.prototype.open=function(){var b=this;if(b.refresh(),!b._properties.animating&&!b._properties.isopen){"function"==typeof b._settings.onOpen&&b._settings.onOpen(b),b._properties.animating=!0;var c=e(this._settings.close,!0)?b._settings.close:b._defaultSettings.close,d=e(this._settings.content,!0)?b._settings.content:"",f=e(this._settings.title,!0)?'<div class="popbox-title">'+b._settings.title+"</div>":"",g=e(this._settings.customClass,!0)?" "+b._settings.customClass:"",h=e(this._settings.gallery.loading,!0)?b._settings.gallery.loading:b._defaultSettings.gallery.loading;b._properties.stored_styles.htmlOverflow=i(b.$html,"overflow"),b._properties.stored_styles.htmlHeight=i(b.$html,"height"),b._properties.stored_styles.htmlMarginRight=i(b.$html,"margin-right");var k=b.$body.width();b.$html.css({overflow:"hidden",height:"100%"});var l=b.$body.width();l>k&&b.$html.css({"margin-right":l-k+"px"}),b.$body.append('<div class="popbox-container'+g+'" style="display: none;"><div class="popbox-bottom-push"></div><a class="popbox-shadow" href="javascript:void(0);"></a><div class="popbox-popup">'+f+'<div class="popbox-content">'+d+'</div><div class="popbox-gallery-loading">'+h+'</div><a href="#" class="popbox-close">'+c+"</a></div></div>"),b.container=a(".popbox-container"),b.popup=b.container.find(".popbox-popup"),b.shadow=b.container.find(".popbox-shadow"),b.bottom_push=b.container.find(".popbox-bottom-push"),b.close_button=b.container.find(".popbox-close"),b.title_area=b.container.find(".popbox-title"),b.content_area=b.container.find(".popbox-content"),b.gallery_loading_area=b.container.find(".popbox-gallery-loading"),b.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)","overflow-x":"hidden"}),b.bottom_push.css({display:"block",position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"}),b.popup.css({display:"block",position:"absolute",top:"0px",left:"0px","z-index":"993","-webkit-box-sizing":"content-box","-moz-box-sizing":"content-box","box-sizing":"content-box"}),b.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991",background:"#fff",opacity:"0",cursor:"default"}),b.content_area.css({overflow:"hidden",height:"auto"}),b.gallery_loading_area.css({overflow:"hidden",height:"auto"}),"gallery"==b._settings.mode&&A(b),b.container.fadeIn(b._settings.fadeInSpeed,function(){j(b,"open")}),b.shadow.click(function(a){b.close(),a.preventDefault()}),b.close_button.click(function(a){b.close(),a.preventDefault()});var m=!1,n=!1,o=0;b.$window.on("resize.popbox",function(){r(b,"fixed"),m&&(n=!0),b.adjust()}).on("scroll.popbox",function(){if(r(b,"fixed"),m)if(n)n=!1;else{b.$window.scrollTop(o);var a=0;"scroll"==b.container.css("overflow-y")?(a=b.container.scrollTop()+Math.round(m.offset().top-b.container.offset().top),a>3&&(a-=3),b.container.scrollTop(a)):(a=b.content_area.scrollTop()+Math.round(m.offset().top-b.content_area.offset().top),a>3&&(a-=3),b.content_area.scrollTop(a)),m=!1}}).on("mousewheel.popbox",function(a){}),b.container.on("focus.popbox","input,textarea,select",function(){r(b,"absolute"),m=a(this),o=b.$window.scrollTop(),setTimeout(function(){m=!1},2e3)}),b._properties.isopen=!0,b._properties.newopen=!0,b._properties.newopentime=(new Date).getTime(),b.adjust(),"function"==typeof b._settings.afterOpen&&b._settings.afterOpen(b)}},C.prototype.update=function(c,d){var f=this;if(c=b(c,{}),d=b(d,!0),f._settings=a.extend(!0,{},f._settings,c),f._properties.isopen){var g=e(f._settings.close,!0)?f._settings.close:f._defaultSettings.close,h=e(f._settings.content,!0)?f._settings.content:"",i=e(f._settings.title,!0)?f._settings.title:"";f.close_button.length>0&&f.close_button.html(g),f.content_area.length>0&&f.content_area.html(h),f.title_area.length>0?""!=i?f.title_area.html(i):(f.title_area.remove(),f.title_area=f.popup.find(".popbox-title")):""!=i&&(f.popup.prepend('<div class="popbox-title">'+i+"</div>"),f.title_area=f.popup.find(".popbox-title")),"gallery"==f._settings.mode?A(f):B(f),d?f.adjust(!0):k(f)}},C.prototype.isOpen=function(){return 1==this._properties.isopen},C.prototype.isClose=function(){return 0==this._properties.isopen},C.prototype.applyDataSettings=function(a){a&&a.length&&g(a,C.prototype._defaultSettings,this._settings)},C.prototype._defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",innerOverflow:!1,scaleToContent:!1,content:"",close:"X",title:"",onOpen:!1,onClose:!1,afterOpen:!1,afterClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200,autoScale:!1,autoSetup:!0,customClass:"",href:"",animateSpeed:400,mode:"normal",gallery:{loading:'<div style="padding:10px;">Loading...</div>',error:'<div style="padding:10px;">There was an error loading the image.</div>',name:"",next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>"}},a.fn.PopBox=function(b){var c=a(this);c.length&&c.each(function(){var c=a(this),d=new C(b);c.click(function(e){e.preventDefault();var h=a.extend(!0,{},b);g(c,C.prototype._defaultSettings,h);var i=h.href||f(c,"href"),j=h.autoSetup,k={},l=!1;if(i&&(null==j||1===j||!0===j||"1"===j||"true"===j)){var m={youtube:[/^(?:http:|https:)?\/\/(?:www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_\-]+)/,/^(?:http:|https:)?\/\/youtu.be\/([a-zA-Z0-9_\-]+)/,/^(?:http:|https:)?\/\/(?:www\.)?youtube\.com\/embed\/([a-zA-Z0-9_\-]+)/],vimeo:[/^(?:http:|https:)?\/\/(?:www\.)?vimeo\.com\/([a-zA-Z0-9_\-]+)/,/^(?:http:|https:)?\/\/player\.vimeo\.com\/video\/([a-zA-Z0-9_\-]+)/],image:[/^(?:http:|https:)?\/\/[a-zA-Z0-9_\-\.\/]+(?:\.jpg|\.png|\.gif)(?:.+)?/,/^[a-zA-Z0-9_\-\.\/]+(?:\.jpg|\.png|\.gif)(?:.+)?/]};a:for(var n in m)if(m.hasOwnProperty(n)&&m[n]instanceof Array)for(var o=0;o<m[n].length;o++){var p=i.match(m[n][o]);if(p){switch(n){case"youtube":k.content='<iframe width="1280" height="720" src="//www.youtube.com/embed/'+p[1]+'" frameborder="0" allowfullscreen></iframe>',k.autoScale=!0;break;case"vimeo":k.content='<iframe width="1280" height="720" src="//player.vimeo.com/video/'+p[1]+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',k.autoScale=!0;break;case"image":k.content='<img src="'+p[0]+'" alt="" />',k.mode="gallery"}a.extend(!0,k,h),l=!0;break a}}}d=new C(l?k:h),d.open()})})},a(".popbox").PopBox(),window.PopBox=C}(jQuery);