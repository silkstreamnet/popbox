!function(a){function b(a,b){return void 0!==a?a:b}function c(a,c){return c=b(c,!1),!isNaN(a-0)&&null!=a&&""!=a&&(!c||a>0)}function d(a,c){return c=b(c,!1),"string"==typeof a&&null!=a&&(!c||""!=a)}function e(a,b){if(a.properties.animating)switch(a.properties.animating=!1,b){case"close":a.container.remove(),a.properties.isopen=!1,a.container=!1,a.popup=!1,a.shadow=!1;break;case"open":a.properties.isopen=!0}}function f(b,d){var e={forceAbsolute:!1,container:window,completeHandler:null,animate:!0,width:"auto",height:"auto",maxwidth:"none",maxheight:"none",push_obj:!1,shadow:!1};a.extend(e,d),b.each(function(d){var f=a(this),g=a(e.container),h=e.container==window;e.forceAbsolute&&(h?f.remove().appendTo("body"):f.remove().appendTo(g.get(0)));var i={position:f.css("position"),visibility:f.css("visibility"),display:f.css("display")},j={visibility:g.css("visibility"),display:g.css("display")},k={position:"absolute",visibility:"hidden",display:"block"},l={visibility:"hidden",display:"block"};f.css(k),h||g.css(l);var m=.8*(h?g.width():g.outerWidth(!1)),n=f.outerWidth(!1)-f.width(),o=m-n;c(e.width)?f.width(e.width):c(e.maxwidth)&&o>e.maxwidth?f.width(e.maxwidth):f.width(o),c(e.height)&&f.height(e.height);var p=.05*(h?g.height():g.outerHeight(!1)),q=h?g.height():g.outerHeight(!1),r=.9*q,s=f.outerHeight(!1),t=!1;s>r?(t=p,g.css("overflow","auto"),e.push_obj.css({top:p+s+"px",height:p+"px",width:"1px"}),e.shadow.css({height:2*p+s+"px"})):(g.css("overflow",""),e.push_obj.css({top:"0px",height:"0px",width:"0px"}),e.shadow.css({height:"100%"}));var u=((h?g.width():g.outerWidth(!1))-f.outerWidth(!1))/2,v=((h?g.height():g.outerHeight(!1))-f.outerHeight(!1))/2;!1!==t&&(v=t),h&&(u+=g.scrollLeft(),v+=g.scrollTop()),f.css(i),h||g.css(j),!0===e.animate?f.stop(!0,!0).animate({left:u,top:v},500):f.stop(!0,!0).css({left:u,top:v}),e.completeHandler&&e.completeHandler(b)})}function g(a,c){a=b(a,!1),c=b(c,!1);var d=!0;if(a&&a.popup){var e=a.popup.find("img");e.length>0&&e.each(function(a,b){b.complete||(d=!1)})}return c&&d&&j(a,!0),d}function h(c){if((c=b(c,!1))&&c.popup){var d=c.popup.find("img");if(d.length>0){var e=0;d.each(function(b,d){d.complete?e++:a(d).load(function(){g(c,!0)})}),d.length==e&&g(c,!0)}}}function i(a){a.properties.loaded_content!==a.settings.content&&(g(a)||h(a),a.properties.loaded_content=a.settings.content)}function j(a,c){c=b(c,!1),(a=b(a,!1))&&f(a.popup,{animate:c,container:a.container,width:a.settings.width,height:a.settings.height,maxwidth:a.settings.maxwidth,maxheight:a.settings.maxheight,push_obj:a.bottom_push,shadow:a.shadow})}var k=function(c){c=b(c,{}),this.settings=a.extend({},this.defaultSettings,c),this.container=!1,this.shadow=!1,this.properties={animating:!1,isopen:!1,resizepause:!1,loaded_content:-1}};k.prototype.adjust=function(a){a=b(a,!1);var c=this;c.properties.resizepause||a&&!c.properties.isopen||(c.properties.resizepause=!0,setTimeout(function(){j(c,a),c.properties.resizepause=!1},c.properties.updatePositionDelay),i(c))},k.prototype.checkImages=function(){this.properties.loaded_content=-1},k.prototype.close=function(){var b=this;!b.properties.animating&&b.properties.isopen&&("function"==typeof b.settings.beforeClose&&b.settings.beforeClose(b),b.properties.animating=!0,b.container.fadeOut(b.settings.fadeOutSpeed,function(){e(b,"close"),a("body").css({overflow:"","margin-right":""})}),a(window).off("resize.popbox.adjust"),b.properties.isopen=!1,"function"==typeof b.settings.onClose&&b.settings.onClose(b))},k.prototype.open=function(){var b=this;if(!b.properties.animating&&!b.properties.isopen){"function"==typeof b.settings.beforeOpen&&b.settings.beforeOpen(b),b.properties.animating=!0;var f=c(this.settings.width,!0)?b.settings.width+"px":"",g=c(this.settings.height,!0)?b.settings.height+"px":"",h=d(this.settings.close,!0)?b.settings.close:this.defaultSettings.close,i=d(this.settings.content,!0)?b.settings.content:"",j=a("body"),k=j.width();j.css("overflow","hidden");var l=j.width();l>k&&j.css("margin-right",l-k+"px"),j.append('<div class="popbox-container" style="display: none;"><div class="popbox-bottom-push"></div><div class="popbox-shadow"></div><div class="popbox-popup"><a class="popbox-close">'+h+"</a>"+i+"</div></div>"),b.container=a(".popbox-container"),b.popup=b.container.find(".popbox-popup"),b.shadow=b.container.find(".popbox-shadow"),b.bottom_push=b.container.find(".popbox-bottom-push"),b.close_button=b.container.find(".popbox-close"),b.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)"}),b.bottom_push.css({display:"block",position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"}),b.popup.css({display:"block",visibility:"visible",position:"absolute",top:"0px",left:"0px",height:g,width:f,"z-index":"993"}),b.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991"}),b.adjust(),b.container.fadeIn(b.settings.fadeInSpeed,function(){e(b,"open")}),b.shadow.click(function(a){b.close(),a.preventDefault()}),b.close_button.click(function(a){b.close(),a.preventDefault()}),a(window).on("resize.popbox.adjust",function(){b.adjust(!0)}),b.properties.isopen=!0,"function"==typeof b.settings.onOpen&&b.settings.onOpen(b)}},k.prototype.setSettings=function(e,f){var g=this;if(e=b(e,{}),f=b(f,!0),g.settings=a.extend({},g.settings,e),g.properties.isopen&&f){var h=c(this.settings.width,!0)?g.settings.width+"px":"",i=c(this.settings.height,!0)?g.settings.height+"px":"",j=d(this.settings.close,!0)?g.settings.close:this.defaultSettings.close,k=d(this.settings.content,!0)?g.settings.content:"";g.popup.html('<a class="popbox-close">'+j+"</a>"+k).css({height:i,width:h}),g.close_button=g.popup.find(".popbox-close"),g.close_button.click(function(a){g.close(),a.preventDefault()}),g.adjust(!0)}},k.prototype.isOpen=function(){return 1==this.properties.isopen},k.prototype.isClose=function(){return 0==this.properties.isopen},k.prototype.defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",content:"",close:"X",onOpen:!1,onClose:!1,beforeOpen:!1,beforeClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200},window.PopBox=k}(jQuery);