!function(s,e){!function(){for(var e="3.0.0".split("."),r=0,t=s.Popbox.prototype.version.split(".").length;r<t;r++)if(s.Popbox.prototype.version.split(".")[r]<e[r])return console.log("Error: Popbox "+e.join(".")+"+ required.")}();var n=s.Popbox.prototype._static;s.extend(!0,s.Popbox.prototype.default_settings,{gallery:{selector:"",clickable:!0,error:'<div class="popbox-gallery-error">There was an error loading the image.</div>',next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>"}});var r=function(){};r.prototype.updateItems=function(){var i=this.self;if(i.settings.gallery.selector){var e=s(i.settings.gallery.selector);e.each(function(){var e=s(this),r=e.data("url"),t=e.attr("href"),l=e.attr("src"),o=!1;r?o=r:t?o=t:l?o=l:(e.find("a[href]").each(function(){var e=s(this).attr("href");e&&!e.match(/^#/)&&n.indexOf(e,i.properties.gallery.items,!0)<0&&i.properties.gallery.items.push(e)}),e.find("img[src]").each(function(){var e=s(this).attr("src");e&&n.indexOf(e,i.properties.gallery.items,!0)<0&&i.properties.gallery.items.push(e)})),o&&n.indexOf(o,i.properties.gallery.items,!0)<0&&i.properties.gallery.items.push(o)}),i.settings.gallery.clickable&&e.off("click.popbox_gallery_open").on("click.popbox_gallery_open",function(e){e.preventDefault();var r=s(this),t=r.data("url"),l=r.attr("href"),o=r.attr("src");if(i.gallery.updateItems(),t)i.gallery.goTo(n.indexOf(t,i.properties.gallery.items,!0));else if(l)i.gallery.goTo(n.indexOf(l,i.properties.gallery.items,!0));else if(o)i.gallery.goTo(n.indexOf(o,i.properties.gallery.items,!0));else{var p=r.find("a[href]:first").attr("href"),a=r.find("img[src]:first").attr("src");p&&!p.match(/^#/)?i.gallery.goTo(n.indexOf(p,i.properties.gallery.items,!0)):a&&i.gallery.goTo(n.indexOf(a,i.properties.gallery.items,!0))}i.open()})}},r.prototype.goTo=function(e){var r=this.self;e=n.isNumber(e)?e:r.properties.gallery.current_index,0<r.properties.gallery.items.length&&(e<-1||e>r.properties.gallery.items.length-1?e=0:e<0&&(e=0<r.properties.gallery.items.length?r.properties.gallery.items.length-1:0),r.properties.gallery.current_index=e,r.update({content:'<img src="'+r.properties.gallery.items[r.properties.gallery.current_index]+'" />'},!0))},r.prototype.next=function(){var e=this.self;e.gallery.goTo(e.properties.gallery.current_index+1)},r.prototype.prev=function(){var e=this.self;e.gallery.goTo(e.properties.gallery.current_index-1)},s.Popbox.prototype.gallery=r,n.addHook("initialize",function(){var e=this;e.gallery=new r,e.gallery.self=e}),n.addHook("after_initialize",function(e){var r=this;"gallery"==r.settings.mode&&e&&!n.isSet(e.aspect_fit)&&(r.settings.aspect_fit=!0),r.gallery.updateItems()}),n.addHook("after_reset",function(){this.properties.gallery={items:[],current_index:0}}),n.addHook("open",function(){var e=this;if("gallery"==e.settings.mode){e.gallery.updateItems();var r=s("<div/>").html(e.settings.content).find("img[src]"),t=-1;r.length&&(t=n.indexOf(r.attr("src"),e.properties.gallery.items,!0)),e.gallery.goTo(t)}}),n.addHook("image_error",function(e){var r=this;"gallery"==r.settings.mode&&(r.update({content:r.settings.gallery.error},!1),r.properties.image_cache[e]&&delete r.properties.image_cache[e])}),n.addHook("after_update",function(){var e=this;e.isOpen()||(e.properties.gallery.items=[],e.properties.gallery.current_index=0),"gallery"==e.settings.mode&&(e.gallery.updateItems(),e.gallery.goTo())}),n.addHook("after_update_dom",function(){var r=this,e=!1;"gallery"===r.settings.mode&&1<r.properties.gallery.items.length&&(r.elements.$popbox_gallery_next||(r.elements.$popbox_gallery_next=s("<a/>",{class:"popbox-gallery-next",href:"javascript:void(0);"}).html(r.settings.gallery.next).appendTo(r.elements.$popbox_container)),r.elements.$popbox_gallery_prev||(r.elements.$popbox_gallery_prev=s("<a/>",{class:"popbox-gallery-prev",href:"javascript:void(0);"}).html(r.settings.gallery.prev).appendTo(r.elements.$popbox_container)),r.elements.$popbox_gallery_next.off("click.popbox_gallery_next").on("click.popbox_gallery_next",function(e){e.preventDefault(),r.gallery.next()}),r.elements.$popbox_gallery_prev.off("click.popbox_gallery_prev").on("click.popbox_gallery_prev",function(e){e.preventDefault(),r.gallery.prev()}),e=!0),e||(r.elements.$popbox_gallery_next&&r.elements.$popbox_gallery_next.remove(),r.elements.$popbox_gallery_prev&&r.elements.$popbox_gallery_prev.remove(),r.elements.$popbox_gallery_next=!1,r.elements.$popbox_gallery_prev=!1)}),s.Popbox.prototype.plugins.gallery="1.0.1"}(jQuery,window);