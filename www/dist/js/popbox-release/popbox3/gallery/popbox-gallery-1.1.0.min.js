!function(u,e){!function(){for(var e="3.0.8".split("."),t=0,o=u.Popbox.prototype.version.split(".").length;t<o;t++)if(u.Popbox.prototype.version.split(".")[t]<e[t])return console.log("Error: Popbox "+e.join(".")+"+ required.")}();var o=function(){},d=u.Popbox.prototype._static;d._gallery_event_namespace="PopboxGallery",u.extend(!0,u.Popbox.prototype.default_settings,{gallery:{selector:"",clickable:!0,error:'<div class="popbox-gallery-error">There was an error loading the image.</div>',next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>",items:[]}}),o.prototype.attachSwipeEvents=function(){var o=this.self,i=this.self.popbox;if(i.elements.$popbox){var r=d._gallery_event_namespace+"Swipe",p=!1,n=!1,a=!1,l=0,g=0,m=0,f=0,t=function(e,t,o,r){return a=!1,!!(n=i.elements.$popbox_popup.find(".popbox-gallery-image")).length&&(n.data("movement")||n.data("movement",0),m=l=e,f=g=t,s(e,t,o,r),!0)},s=function(e,t,o,r){m=e,f=t;var p=Math.abs(m-l)-8,s=Math.abs(f-g)-8;if(!a){if(!(0<p&&s<p))return void((0<p||0<s)&&p<s&&c(o,r));a=!0,u("<div/>").css({position:"absolute",top:"0",left:"0",right:"0",bottom:"0","z-index":i.settings.z_index+50}).addClass("popbox-swipe-shield").appendTo(i.elements.$popbox_popup)}d._support.transform3d?n.css("transform","translate3d("+(m-l+n.data("movement"))+"px,0px,0px"):n.css("transform","translate("+(m-l+n.data("movement"))+"px,0px")},c=function(e,t){return p=!1,d.$document.off("touchmove."+r),d.$document.off("touchend."+r),d.$document.off("mousemove."+r),d.$document.off("mouseup."+r),n.data("movement",m-l+n.data("movement")),a&&(e.stopImmediatePropagation(),e.preventDefault(),l<m?o.prev():m<l&&o.next()),i.elements.$popbox_popup.find(".popbox-swipe-shield").remove(),!a};i.elements.$popbox.off("dragstart."+r).on("dragstart."+r,".popbox-popup",function(e){e.preventDefault()}),i.elements.$popbox.off("touchstart."+r).on("touchstart."+r,".popbox-popup",function(e){p=!0,t(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY,e,"touch")?(d.$document.off("touchmove."+r).on("touchmove."+r,function(e){s(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY,e,"touch")}),d.$document.off("touchend."+r).on("touchend."+r,function(e){return c(e,"touch")})):p=!1}),i.elements.$popbox.off("mousedown."+r).on("mousedown."+r,".popbox-popup",function(e){p||1!==e.which||t(e.pageX,e.pageY,e,"mouse")&&(d.$document.off("mousemove."+r).on("mousemove."+r,function(e){s(e.pageX,e.pageY,e,"mouse")}),d.$document.off("mouseup."+r).on("mouseup."+r,function(e){if(1===e.which)return c(e,"mouse")}))}),i.elements.$popbox.off("click."+r).on("click."+r,".popbox-popup",function(e){if(a)return e.stopImmediatePropagation(),e.preventDefault(),!1})}},o.prototype.attachNavEvents=function(){var t=this.self,e=this.self.popbox;if(e.elements.$popbox){var o=d._gallery_event_namespace+"Nav";e.elements.$popbox.off("click."+o),e.elements.$popbox.on("click."+o,".popbox-gallery-next",function(e){e.preventDefault(),t.next()}),e.elements.$popbox.on("click."+o,".popbox-gallery-prev",function(e){e.preventDefault(),t.prev()})}};var t=function(e){var t=this;t.popbox=e,t._private=new o,t._private.self=t};t.prototype.refreshItems=function(){var n=this,a=this.popbox;if(d.isArray(a.settings.gallery.items)&&0<a.settings.gallery.items.length)for(var e=0;e<a.settings.gallery.items.length;e++)a.properties.gallery.items.push(a.settings.gallery.items[e]);if(a.settings.gallery.selector){var t=u(a.settings.gallery.selector);t.each(function(){var e=u(this),t=e.data("url"),o=e.attr("href"),r=e.attr("src"),p=!1;t?p=t:o?p=o:r?p=r:(e.find("a[href]").each(function(){var e=u(this).attr("href");e&&!e.match(/^#/)&&d.indexOf(e,a.properties.gallery.items,!0)<0&&a.properties.gallery.items.push(e)}),e.find("img[src]").each(function(){var e=u(this).attr("src");e&&d.indexOf(e,a.properties.gallery.items,!0)<0&&a.properties.gallery.items.push(e)})),p&&d.indexOf(p,a.properties.gallery.items,!0)<0&&a.properties.gallery.items.push(p)}),a.settings.gallery.clickable&&t.off("click.popbox_gallery_open").on("click.popbox_gallery_open",function(e){e.preventDefault();var t=u(this),o=t.data("url"),r=t.attr("href"),p=t.attr("src");if(n.refreshItems(),o)n.goTo(d.indexOf(o,a.properties.gallery.items,!0));else if(r)n.goTo(d.indexOf(r,a.properties.gallery.items,!0));else if(p)n.goTo(d.indexOf(p,a.properties.gallery.items,!0));else{var s=t.find("a[href]:first").attr("href"),i=t.find("img[src]:first").attr("src");s&&!s.match(/^#/)?n.goTo(d.indexOf(s,a.properties.gallery.items,!0)):i&&n.goTo(d.indexOf(i,a.properties.gallery.items,!0))}a.open()})}},t.prototype.addItem=function(e){this.addItems([e])},t.prototype.removeItem=function(e){this.removeItems([e])},t.prototype.addItems=function(e){var t=this.popbox;if(e){d.isArray(t.settings.gallery.items)||(t.settings.gallery.items=[]),d.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++)t.settings.gallery.items.push(e[o])}},t.prototype.removeItems=function(e){var t=this.popbox;if(e&&d.isArray(t.settings.gallery.items)){d.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++){var r=d.indexOf(e[o],t.settings.gallery.items);0<=r&&t.settings.gallery.items.splice(r,1)}}},t.prototype.goTo=function(e){var t=this.popbox;e=d.isNumber(e)?e:t.properties.gallery.current_index,0<t.properties.gallery.items.length&&(e>t.properties.gallery.items.length-1?e=0:e<0&&(e=0<t.properties.gallery.items.length?t.properties.gallery.items.length-1:0),t.properties.gallery.current_index=e,t.update({content:'<div class="popbox-gallery-container" style="overflow:hidden;"><div class="popbox-gallery-image"><img src="'+t.properties.gallery.items[t.properties.gallery.current_index]+'" /></div></div>'},!0))},t.prototype.next=function(){var e=this.popbox;this.goTo(e.properties.gallery.current_index+1)},t.prototype.prev=function(){var e=this.popbox;this.goTo(e.properties.gallery.current_index-1)},u.Popbox.prototype.gallery=t,d.addHook("initialize",function(){this.gallery=new t(this)}),d.addHook("after_initialize",function(e){var t=this.gallery;"gallery"===this.settings.mode&&(e&&!d.isSet(e.aspect_fit)&&(this.settings.aspect_fit=!0),t.refreshItems())}),d.addHook("after_reset",function(){this.properties.gallery={items:[],current_index:0}}),d.addHook("after_create",function(){var e=this.gallery;"gallery"===this.settings.mode&&(e._private.attachSwipeEvents(),e._private.attachNavEvents())}),d.addHook("open",function(){var e=this.gallery;if("gallery"===this.settings.mode){e.refreshItems();var t=u("<div/>").html(this.settings.content).find("img[src]"),o=0;t.length&&(o=d.indexOf(t.attr("src"),this.properties.gallery.items,!0)),e.goTo(o)}}),d.addHook("image_error",function(e){var t=this;"gallery"===t.settings.mode&&(t.update({content:t.settings.gallery.error},!1),t.properties.image_cache[e]&&delete t.properties.image_cache[e])}),d.addHook("after_update",function(){var e=this.gallery;this.isOpen()||(this.properties.gallery.items=[],this.properties.gallery.current_index=0),"gallery"===this.settings.mode&&(e.refreshItems(),e.goTo())}),d.addHook("after_update_dom",function(){var e=this,t=!1;"gallery"===e.settings.mode&&(e.elements.$popbox.addClass("popbox-gallery"),1<e.properties.gallery.items.length&&(e.elements.$popbox_gallery_next||(e.elements.$popbox_gallery_next=u("<a/>",{class:"popbox-gallery-next",href:"javascript:void(0);"}).html(e.settings.gallery.next).appendTo(e.elements.$popbox_container)),e.elements.$popbox_gallery_prev||(e.elements.$popbox_gallery_prev=u("<a/>",{class:"popbox-gallery-prev",href:"javascript:void(0);"}).html(e.settings.gallery.prev).appendTo(e.elements.$popbox_container)),t=!0)),t||(e.elements.$popbox_gallery_next&&e.elements.$popbox_gallery_next.remove(),e.elements.$popbox_gallery_prev&&e.elements.$popbox_gallery_prev.remove(),e.elements.$popbox_gallery_next=!1,e.elements.$popbox_gallery_prev=!1)}),u.Popbox.prototype.plugins.gallery="1.1.0"}(jQuery,window);