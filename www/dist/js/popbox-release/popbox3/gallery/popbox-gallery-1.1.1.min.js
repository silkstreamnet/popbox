!function(y,e){!function(){for(var e="3.0.8".split("."),t=0,o=y.Popbox.prototype.version.split(".").length;t<o;t++)if(y.Popbox.prototype.version.split(".")[t]<e[t])return console.log("Error: Popbox "+e.join(".")+"+ required.")}();var t=function(){},v=y.Popbox.prototype._static;v._gallery_event_namespace="PopboxGallery",y.extend(!0,y.Popbox.prototype.default_settings,{gallery:{selector:"",clickable:!0,error:'<div class="popbox-gallery-error">There was an error loading the image.</div>',next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>",items:[]}}),t.prototype.attachSwipeEvents=function(){var a=this.self,l=this.self.popbox;if(l.elements.$popbox){var g=v._gallery_event_namespace+"Swipe",f=!1,m=!1,c=!1,d=0,i=0,u=0,p=0,h=[],t=function(e,t,o){return c=!1,!!(m=l.elements.$popbox_popup.find(".popbox-gallery-image")).length&&(m.data("movement")||m.data("movement",0),u=d=e,p=i=t,r(e,t,o),!0)},r=function(e,t,o){h.push({distance:e-u,time:(new Date).getTime()}),10<h.length&&h.shift(),u=e,p=t;var r=Math.abs(u-d)-8,s=Math.abs(p-i)-8;if(!c){if(!(0<r&&s<r))return void((0<r||0<s)&&r<s&&n(o));c=!0,y("<div/>").css({position:"absolute",top:"0",left:"0",right:"0",bottom:"0","z-index":l.settings.z_index+50}).addClass("popbox-swipe-shield").appendTo(l.elements.$popbox_popup),n(o)}v._support.transform3d?m.css("transform","translate3d("+(u-d+m.data("movement"))+"px,0px,0px"):m.css("transform","translate("+(u-d+m.data("movement"))+"px,0px")},n=function(e){f=!1,v.$document.off("touchmove."+g),v.$document.off("touchend."+g),v.$document.off("mousemove."+g),v.$document.off("mouseup."+g);var t=u-d+m.data("movement");if(m.data("movement",t),c&&(e.stopImmediatePropagation(),e.preventDefault(),d<u?a.prev():u<d&&a.next()),l.elements.$popbox_popup.find(".popbox-swipe-shield").remove(),h.length){for(var o=0,r=0,s=h[h.length-1].time,i=0,p=h.length-1;0<=p;p--){if(i){if(1===i&&h[p].distance<=0||-1===i&&0<=h[p].distance){r=h[p].time;break}}else 0<h[p].distance?i=1:h[p].distance<0&&(i=-1);o+=h[p].distance,r=h[p].time}if(0<r&&r!==s){var n=o/(s-r);m.css("transition","ease-in 300ms transform"),v._support.transform3d?m.css("transform","translate3d("+(t+300*n)+"px,0px,0px"):m.css("transform","translate("+(t+300*n)+"px,0px")}}return!c};l.elements.$popbox.off("dragstart."+g).on("dragstart."+g,".popbox-popup",function(e){e.preventDefault()}),l.elements.$popbox.off("touchstart."+g).on("touchstart."+g,".popbox-popup",function(e){f=!0,t(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY,e)?(v.$document.off("touchmove."+g).on("touchmove."+g,function(e){r(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY,e)}),v.$document.off("touchend."+g).on("touchend."+g,function(e){return n(e)})):f=!1}),l.elements.$popbox.off("mousedown."+g).on("mousedown."+g,".popbox-popup",function(e){f||1!==e.which||t(e.pageX,e.pageY,e)&&(v.$document.off("mousemove."+g).on("mousemove."+g,function(e){r(e.pageX,e.pageY,e)}),v.$document.off("mouseup."+g).on("mouseup."+g,function(e){if(1===e.which)return n(e)}))}),l.elements.$popbox.off("click."+g).on("click."+g,".popbox-popup",function(e){if(c)return e.stopImmediatePropagation(),e.preventDefault(),!1})}},t.prototype.attachNavEvents=function(){var t=this.self,e=this.self.popbox;if(e.elements.$popbox){var o=v._gallery_event_namespace+"Nav";e.elements.$popbox.off("click."+o),e.elements.$popbox.on("click."+o,".popbox-gallery-next",function(e){e.preventDefault(),t.next()}),e.elements.$popbox.on("click."+o,".popbox-gallery-prev",function(e){e.preventDefault(),t.prev()})}};var o=function(e){this.popbox=e,this._private=new t,this._private.self=this};o.prototype.refreshItems=function(){var n=this,a=this.popbox;if(v.isArray(a.settings.gallery.items)&&0<a.settings.gallery.items.length)for(var e=0;e<a.settings.gallery.items.length;e++)a.properties.gallery.items.push(a.settings.gallery.items[e]);if(a.settings.gallery.selector){var t=y(a.settings.gallery.selector);t.each(function(){var e=y(this),t=e.data("url"),o=e.attr("href"),r=e.attr("src"),s=!1;t?s=t:o?s=o:r?s=r:(e.find("a[href]").each(function(){var e=y(this).attr("href");e&&!e.match(/^#/)&&v.indexOf(e,a.properties.gallery.items,!0)<0&&a.properties.gallery.items.push(e)}),e.find("img[src]").each(function(){var e=y(this).attr("src");e&&v.indexOf(e,a.properties.gallery.items,!0)<0&&a.properties.gallery.items.push(e)})),s&&v.indexOf(s,a.properties.gallery.items,!0)<0&&a.properties.gallery.items.push(s)}),a.settings.gallery.clickable&&t.off("click.popbox_gallery_open").on("click.popbox_gallery_open",function(e){e.preventDefault();var t=y(this),o=t.data("url"),r=t.attr("href"),s=t.attr("src");if(n.refreshItems(),o)n.goTo(v.indexOf(o,a.properties.gallery.items,!0));else if(r)n.goTo(v.indexOf(r,a.properties.gallery.items,!0));else if(s)n.goTo(v.indexOf(s,a.properties.gallery.items,!0));else{var i=t.find("a[href]:first").attr("href"),p=t.find("img[src]:first").attr("src");i&&!i.match(/^#/)?n.goTo(v.indexOf(i,a.properties.gallery.items,!0)):p&&n.goTo(v.indexOf(p,a.properties.gallery.items,!0))}a.open()})}},o.prototype.addItem=function(e){this.addItems([e])},o.prototype.removeItem=function(e){this.removeItems([e])},o.prototype.addItems=function(e){var t=this.popbox;if(e){v.isArray(t.settings.gallery.items)||(t.settings.gallery.items=[]),v.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++)t.settings.gallery.items.push(e[o])}},o.prototype.removeItems=function(e){var t=this.popbox;if(e&&v.isArray(t.settings.gallery.items)){v.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++){var r=v.indexOf(e[o],t.settings.gallery.items);0<=r&&t.settings.gallery.items.splice(r,1)}}},o.prototype.goTo=function(e){var t=this.popbox;e=v.isNumber(e)?e:t.properties.gallery.current_index,0<t.properties.gallery.items.length&&(e>t.properties.gallery.items.length-1?e=0:e<0&&(e=0<t.properties.gallery.items.length?t.properties.gallery.items.length-1:0),t.properties.gallery.current_index=e,t.update({content:'<div class="popbox-gallery-container" style="overflow:hidden;"><div class="popbox-gallery-image"><img src="'+t.properties.gallery.items[t.properties.gallery.current_index]+'" /></div></div>'},!0))},o.prototype.next=function(){var e=this.popbox;this.goTo(e.properties.gallery.current_index+1)},o.prototype.prev=function(){var e=this.popbox;this.goTo(e.properties.gallery.current_index-1)},y.Popbox.prototype.gallery=o,v.addHook("initialize",function(){this.gallery=new o(this)}),v.addHook("after_initialize",function(e){var t=this.gallery;"gallery"===this.settings.mode&&(e&&!v.isSet(e.aspect_fit)&&(this.settings.aspect_fit=!0),t.refreshItems())}),v.addHook("after_reset",function(){this.properties.gallery={items:[],current_index:0}}),v.addHook("after_create",function(){var e=this.gallery;"gallery"===this.settings.mode&&(e._private.attachSwipeEvents(),e._private.attachNavEvents())}),v.addHook("open",function(){var e=this.gallery;if("gallery"===this.settings.mode){e.refreshItems();var t=y("<div/>").html(this.settings.content).find("img[src]"),o=0;t.length&&(o=v.indexOf(t.attr("src"),this.properties.gallery.items,!0)),e.goTo(o)}}),v.addHook("image_error",function(e){var t=this;"gallery"===t.settings.mode&&(t.update({content:t.settings.gallery.error},!1),t.properties.image_cache[e]&&delete t.properties.image_cache[e])}),v.addHook("after_update",function(){var e=this.gallery;this.isOpen()||(this.properties.gallery.items=[],this.properties.gallery.current_index=0),"gallery"===this.settings.mode&&(e.refreshItems(),e.goTo())}),v.addHook("after_update_dom",function(){var e=this,t=!1;"gallery"===e.settings.mode&&(e.elements.$popbox.addClass("popbox-gallery"),1<e.properties.gallery.items.length&&(e.elements.$popbox_gallery_next||(e.elements.$popbox_gallery_next=y("<a/>",{class:"popbox-gallery-next",href:"javascript:void(0);"}).html(e.settings.gallery.next).appendTo(e.elements.$popbox_container)),e.elements.$popbox_gallery_prev||(e.elements.$popbox_gallery_prev=y("<a/>",{class:"popbox-gallery-prev",href:"javascript:void(0);"}).html(e.settings.gallery.prev).appendTo(e.elements.$popbox_container)),t=!0)),t||(e.elements.$popbox_gallery_next&&e.elements.$popbox_gallery_next.remove(),e.elements.$popbox_gallery_prev&&e.elements.$popbox_gallery_prev.remove(),e.elements.$popbox_gallery_next=!1,e.elements.$popbox_gallery_prev=!1)}),y.Popbox.prototype.plugins.gallery="1.1.1"}(jQuery,window);