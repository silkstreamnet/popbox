!function(a,b){!function(){for(var b="3.0.7".split("."),c=0,d=a.Popbox.prototype.version.split(".").length;c<d;c++)if(a.Popbox.prototype.version.split(".")[c]<b[c])return void console.log("Error: Popbox "+b.join(".")+"+ required.")}();var c=a.Popbox.prototype._static,d={gallery:{selector:"",clickable:!0,error:'<div class="popbox-gallery-error">There was an error loading the image.</div>',next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>"}};a.extend(!0,a.Popbox.prototype.default_settings,d);var e=function(){};e.prototype.updateItems=function(){var b=this.self;if(b.settings.gallery.selector){var d=a(b.settings.gallery.selector);d.each(function(){var d=a(this),e=d.data("url"),f=d.attr("href"),g=d.attr("src"),h=!1;e?h=e:f?h=f:g?h=g:(d.find("a[href]").each(function(){var d=a(this).attr("href");d&&!d.match(/^#/)&&c.indexOf(d,b.properties.gallery.items,!0)<0&&b.properties.gallery.items.push(d)}),d.find("img[src]").each(function(){var d=a(this).attr("src");d&&c.indexOf(d,b.properties.gallery.items,!0)<0&&b.properties.gallery.items.push(d)})),h&&c.indexOf(h,b.properties.gallery.items,!0)<0&&b.properties.gallery.items.push(h)}),b.settings.gallery.clickable&&d.off("click.popbox_gallery_open").on("click.popbox_gallery_open",function(d){d.preventDefault();var e=a(this),f=e.data("url"),g=e.attr("href"),h=e.attr("src");if(b.gallery.updateItems(),f)b.gallery.goTo(c.indexOf(f,b.properties.gallery.items,!0));else if(g)b.gallery.goTo(c.indexOf(g,b.properties.gallery.items,!0));else if(h)b.gallery.goTo(c.indexOf(h,b.properties.gallery.items,!0));else{var i=e.find("a[href]:first").attr("href"),j=e.find("img[src]:first").attr("src");i&&!i.match(/^#/)?b.gallery.goTo(c.indexOf(i,b.properties.gallery.items,!0)):j&&b.gallery.goTo(c.indexOf(j,b.properties.gallery.items,!0))}b.open()})}},e.prototype.goTo=function(a){var b=this.self;a=c.isNumber(a)?a:b.properties.gallery.current_index,b.properties.gallery.items.length>0&&(a<-1||a>b.properties.gallery.items.length-1?a=0:a<0&&(a=b.properties.gallery.items.length>0?b.properties.gallery.items.length-1:0),b.properties.gallery.current_index=a,b.update({content:'<img src="'+b.properties.gallery.items[b.properties.gallery.current_index]+'" />'},!0))},e.prototype.next=function(){var a=this.self;a.gallery.goTo(a.properties.gallery.current_index+1)},e.prototype.prev=function(){var a=this.self;a.gallery.goTo(a.properties.gallery.current_index-1)},a.Popbox.prototype.gallery=e,c.addHook("initialize",function(){var a=this;a.gallery=new e,a.gallery.self=a}),c.addHook("after_initialize",function(a){var b=this;"gallery"==b.settings.mode&&a&&!c.isSet(a.aspect_fit)&&(b.settings.aspect_fit=!0,b.settings.aspect_fit_round=!0),b.gallery.updateItems()}),c.addHook("after_reset",function(){this.properties.gallery={items:[],current_index:0}}),c.addHook("open",function(){var b=this;if("gallery"==b.settings.mode){b.gallery.updateItems();var d=a("<div/>").html(b.settings.content).find("img[src]"),e=-1;d.length&&(e=c.indexOf(d.attr("src"),b.properties.gallery.items,!0)),b.gallery.goTo(e)}}),c.addHook("image_error",function(a){var b=this;"gallery"==b.settings.mode&&(b.update({content:b.settings.gallery.error},!1),b.properties.image_cache[a]&&delete b.properties.image_cache[a])}),c.addHook("after_update",function(){var a=this;a.isOpen()||(a.properties.gallery.items=[],a.properties.gallery.current_index=0),"gallery"==a.settings.mode&&(a.gallery.updateItems(),a.gallery.goTo())}),c.addHook("after_update_dom",function(){var b=this,c=!1;"gallery"===b.settings.mode&&b.properties.gallery.items.length>1&&(b.elements.$popbox_gallery_next||(b.elements.$popbox_gallery_next=a("<a/>",{class:"popbox-gallery-next",href:"javascript:void(0);"}).html(b.settings.gallery.next).appendTo(b.elements.$popbox_container)),b.elements.$popbox_gallery_prev||(b.elements.$popbox_gallery_prev=a("<a/>",{class:"popbox-gallery-prev",href:"javascript:void(0);"}).html(b.settings.gallery.prev).appendTo(b.elements.$popbox_container)),b.elements.$popbox_gallery_next.off("click.popbox_gallery_next").on("click.popbox_gallery_next",function(a){a.preventDefault(),b.gallery.next()}),b.elements.$popbox_gallery_prev.off("click.popbox_gallery_prev").on("click.popbox_gallery_prev",function(a){a.preventDefault(),b.gallery.prev()}),c=!0),c||(b.elements.$popbox_gallery_next&&b.elements.$popbox_gallery_next.remove(),b.elements.$popbox_gallery_prev&&b.elements.$popbox_gallery_prev.remove(),b.elements.$popbox_gallery_next=!1,b.elements.$popbox_gallery_prev=!1)}),a.Popbox.prototype.plugins.gallery="1.0.2"}(jQuery,window);