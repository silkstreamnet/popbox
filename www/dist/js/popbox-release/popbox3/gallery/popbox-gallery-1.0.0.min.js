!function(a,e){!function(){for(var e="3.0.0".split("."),r=0,t=a.Popbox.prototype.version.split(".").length;r<t;r++)if(a.Popbox.prototype.version.split(".")[r]<e[r])return console.log("Error: Popbox "+e.join(".")+"+ required.")}();var s=a.Popbox.prototype._static;a.extend(!0,a.Popbox.prototype.default_settings,{gallery:{selector:"",clickable:!0,error:'<div class="popbox-gallery-error">There was an error loading the image.</div>',next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>"}});var r=function(){};r.prototype.updateItems=function(){var i=this.self;if(i.settings.gallery.selector){var e=a(i.settings.gallery.selector);e.each(function(){var e=a(this),r=e.attr("href"),t=e.attr("src"),l=!1;r?l=r:t?l=t:(e.find("a[href]").each(function(){var e=a(this).attr("href");e&&!e.match(/^#/)&&s.indexOf(e,i.properties.gallery.items,!0)<0&&i.properties.gallery.items.push(e)}),e.find("img[src]").each(function(){var e=a(this).attr("src");e&&s.indexOf(e,i.properties.gallery.items,!0)<0&&i.properties.gallery.items.push(e)})),l&&s.indexOf(l,i.properties.gallery.items,!0)<0&&i.properties.gallery.items.push(l)}),i.settings.gallery.clickable&&e.off("click.popbox_gallery_open").on("click.popbox_gallery_open",function(e){e.preventDefault();var r=a(this),t=r.attr("href"),l=r.attr("src");if(i.gallery.updateItems(),t)i.gallery.goTo(s.indexOf(t,i.properties.gallery.items,!0));else if(l)i.gallery.goTo(s.indexOf(l,i.properties.gallery.items,!0));else{var o=r.find("a[href]:first").attr("href"),p=r.find("img[src]:first").attr("src");o&&!o.match(/^#/)?i.gallery.goTo(s.indexOf(o,i.properties.gallery.items,!0)):p&&i.gallery.goTo(s.indexOf(p,i.properties.gallery.items,!0))}i.open()})}},r.prototype.goTo=function(e){var r=this.self;e=s.isNumber(e)?e:r.properties.gallery.current_index,0<r.properties.gallery.items.length&&(e<-1||e>r.properties.gallery.items.length-1?e=0:e<0&&(e=0<r.properties.gallery.items.length?r.properties.gallery.items.length-1:0),r.properties.gallery.current_index=e,r.update({content:'<img src="'+r.properties.gallery.items[r.properties.gallery.current_index]+'" />'},!0))},r.prototype.next=function(){var e=this.self;e.gallery.goTo(e.properties.gallery.current_index+1)},r.prototype.prev=function(){var e=this.self;e.gallery.goTo(e.properties.gallery.current_index-1)},a.Popbox.prototype.gallery=r,s.addHook("initialize",function(){var e=this;e.gallery=new r,e.gallery.self=e}),s.addHook("after_initialize",function(e){var r=this;"gallery"==r.settings.mode&&e&&!s.isSet(e.aspect_fit)&&(r.settings.aspect_fit=!0),r.gallery.updateItems()}),s.addHook("after_reset",function(){this.properties.gallery={items:[],current_index:0}}),s.addHook("open",function(){var e=this;if("gallery"==e.settings.mode){e.gallery.updateItems();var r=a("<div/>").html(e.settings.content).find("img[src]"),t=-1;r.length&&(t=s.indexOf(r.attr("src"),e.properties.gallery.items,!0)),e.gallery.goTo(t)}}),s.addHook("image_error",function(e){var r=this;"gallery"==r.settings.mode&&(r.update({content:r.settings.gallery.error},!1),r.properties.image_cache[e]&&delete r.properties.image_cache[e])}),s.addHook("after_update",function(){var e=this;e.isOpen()||(e.properties.gallery.items=[],e.properties.gallery.current_index=0),"gallery"==e.settings.mode&&(e.gallery.updateItems(),e.gallery.goTo())}),s.addHook("after_update_dom",function(){var r=this,e=!1;"gallery"===r.settings.mode&&1<r.properties.gallery.items.length&&(r.elements.$popbox_gallery_next||(r.elements.$popbox_gallery_next=a("<a/>",{class:"popbox-gallery-next",href:"javascript:void(0);"}).html(r.settings.gallery.next).appendTo(r.elements.$popbox_container)),r.elements.$popbox_gallery_prev||(r.elements.$popbox_gallery_prev=a("<a/>",{class:"popbox-gallery-prev",href:"javascript:void(0);"}).html(r.settings.gallery.prev).appendTo(r.elements.$popbox_container)),r.elements.$popbox_gallery_next.off("click.popbox_gallery_next").on("click.popbox_gallery_next",function(e){e.preventDefault(),r.gallery.next()}),r.elements.$popbox_gallery_prev.off("click.popbox_gallery_prev").on("click.popbox_gallery_prev",function(e){e.preventDefault(),r.gallery.prev()}),e=!0),e||(r.elements.$popbox_gallery_next&&r.elements.$popbox_gallery_next.remove(),r.elements.$popbox_gallery_prev&&r.elements.$popbox_gallery_prev.remove(),r.elements.$popbox_gallery_next=!1,r.elements.$popbox_gallery_prev=!1)}),a.Popbox.prototype.plugins.gallery="1.0.0"}(jQuery,window);