!function(y,e){!function(){for(var e="3.0.10".split("."),t=0,o=y.Popbox.prototype.version.split(".");t<o.length;t++)+o[t]<+e[t]&&console.log("Error: Popbox "+e.join(".")+"+ required.")}();var t=function(){},x=y.Popbox.prototype._static;x._gallery_event_namespace="PopboxGallery",y.extend(!0,y.Popbox.prototype.default_settings,{gallery:{selector:"",clickable:!0,swipeable:!0,error:'<div class="popbox-gallery-error">There was an error loading the image.</div>',next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>",items:[]}}),t.prototype.attachSwipeEvents=function(){var n=this.self,l=this.self.popbox;if(l.elements.$popbox&&l.settings.gallery.swipeable){var g=x._gallery_event_namespace+"Swipe",f=!1,m=!1,c=!1,d=0,i=0,h=0,p=0,u=[],t=function(e,t,o){return c=!1,!!(m=l.elements.$popbox_popup.find(".popbox-gallery-image")).length&&(m.data("movement")||m.data("movement",0),h=d=e,p=i=t,r(e,t,o),!0)},r=function(e,t,o){u.push({distance:e-h,time:(new Date).getTime()}),10<u.length&&u.shift(),h=e,p=t;var r=Math.abs(h-d)-8,s=Math.abs(p-i)-8;if(!c){if(!(0<r&&s<r))return void((0<r||0<s)&&r<s&&a(o));c=!0,y("<div/>").css({position:"absolute",top:"0",left:"0",right:"0",bottom:"0","z-index":l.settings.z_index+50}).addClass("popbox-swipe-shield").appendTo(l.elements.$popbox_popup),a(o)}x._support.transform3d?m.css("transform","translate3d("+(h-d+m.data("movement"))+"px,0px,0px"):m.css("transform","translate("+(h-d+m.data("movement"))+"px,0px")},a=function(e){f=!1,x.$document.off("touchmove."+g),x.$document.off("touchend."+g),x.$document.off("mousemove."+g),x.$document.off("mouseup."+g);var t=h-d+m.data("movement");if(m.data("movement",t),c&&(e.stopImmediatePropagation(),e.preventDefault(),d<h?n.prev():h<d&&n.next()),l.elements.$popbox_popup.find(".popbox-swipe-shield").remove(),c&&u.length){for(var o=0,r=0,s=u[u.length-1].time,i=0,p=u.length-1;0<=p;p--){if(i){if(1===i&&u[p].distance<=0||-1===i&&0<=u[p].distance){r=u[p].time;break}}else 0<u[p].distance?i=1:u[p].distance<0&&(i=-1);o+=u[p].distance,r=u[p].time}if(0<r&&r!==s){var a=o/(s-r);m.css("transition","ease-in 300ms transform"),x._support.transform3d?m.css("transform","translate3d("+(t+300*a)+"px,0px,0px"):m.css("transform","translate("+(t+300*a)+"px,0px")}}else m.css("transform","translate3d(0px,0px,0px");return!c};l.elements.$popbox.off("dragstart."+g).on("dragstart."+g,".popbox-popup",function(e){e.preventDefault()}),l.elements.$popbox.off("touchstart."+g).on("touchstart."+g,".popbox-popup",function(e){f=!0,t(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY,e)?(x.$document.off("touchmove."+g).on("touchmove."+g,function(e){r(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY,e)}),x.$document.off("touchend."+g).on("touchend."+g,function(e){return a(e)})):f=!1}),l.elements.$popbox.off("mousedown."+g).on("mousedown."+g,".popbox-popup",function(e){f||1!==e.which||t(e.pageX,e.pageY,e)&&(x.$document.off("mousemove."+g).on("mousemove."+g,function(e){r(e.pageX,e.pageY,e)}),x.$document.off("mouseup."+g).on("mouseup."+g,function(e){if(1===e.which)return a(e)}))}),l.elements.$popbox.off("click."+g).on("click."+g,".popbox-popup",function(e){if(c)return e.stopImmediatePropagation(),e.preventDefault(),!1})}},t.prototype.detachSwipeEvents=function(){this.self;var e=this.self.popbox;if(e.elements.$popbox){var t=x._gallery_event_namespace+"Swipe";e.elements.$popbox.off("dragstart."+t),e.elements.$popbox.off("touchstart."+t),e.elements.$popbox.off("mousedown."+t),e.elements.$popbox.off("click."+t)}},t.prototype.attachNavEvents=function(){var t=this.self,e=this.self.popbox;if(e.elements.$popbox){var o=x._gallery_event_namespace+"Nav";e.elements.$popbox.off("click."+o),e.elements.$popbox.on("click."+o,".popbox-gallery-next",function(e){e.preventDefault(),t.next()}),e.elements.$popbox.on("click."+o,".popbox-gallery-prev",function(e){e.preventDefault(),t.prev()})}};var o=function(e){this.popbox=e,this._private=new t,this._private.self=this};o.prototype.refreshItems=function(){var a=this,n=this.popbox;if(x.isArray(n.settings.gallery.items)&&0<n.settings.gallery.items.length)for(var e=0;e<n.settings.gallery.items.length;e++)n.properties.gallery.items.push(n.settings.gallery.items[e]);if(n.settings.gallery.selector){var t=y(n.settings.gallery.selector);t.each(function(){var e=y(this),t=e.data("url"),o=e.attr("href"),r=e.attr("src"),s=!1;t?s=t:o?s=o:r?s=r:(e.find("a[href]").each(function(){var e=y(this).attr("href");e&&!e.match(/^#/)&&x.indexOf(e,n.properties.gallery.items,!0)<0&&n.properties.gallery.items.push(e)}),e.find("img[src]").each(function(){var e=y(this).attr("src");e&&x.indexOf(e,n.properties.gallery.items,!0)<0&&n.properties.gallery.items.push(e)})),s&&x.indexOf(s,n.properties.gallery.items,!0)<0&&n.properties.gallery.items.push(s)}),n.settings.gallery.clickable&&t.off("click.popbox_gallery_open").on("click.popbox_gallery_open",function(e){e.preventDefault();var t=y(this),o=t.data("url"),r=t.attr("href"),s=t.attr("src");if(a.refreshItems(),o)a.goTo(x.indexOf(o,n.properties.gallery.items,!0));else if(r)a.goTo(x.indexOf(r,n.properties.gallery.items,!0));else if(s)a.goTo(x.indexOf(s,n.properties.gallery.items,!0));else{var i=t.find("a[href]:first").attr("href"),p=t.find("img[src]:first").attr("src");i&&!i.match(/^#/)?a.goTo(x.indexOf(i,n.properties.gallery.items,!0)):p&&a.goTo(x.indexOf(p,n.properties.gallery.items,!0))}n.open()})}},o.prototype.addItem=function(e){this.addItems([e])},o.prototype.removeItem=function(e){this.removeItems([e])},o.prototype.addItems=function(e){var t=this.popbox;if(e){x.isArray(t.base_settings.gallery.items)||(t.base_settings.gallery.items=[]),x.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++)t.base_settings.gallery.items.push(e[o]);t._private.applySettings()}},o.prototype.removeItems=function(e){var t=this.popbox;if(e&&x.isArray(t.base_settings.gallery.items)){x.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++){var r=x.indexOf(e[o],t.base_settings.gallery.items);0<=r&&t.base_settings.gallery.items.splice(r,1)}t._private.applySettings()}},o.prototype.goTo=function(e){var t=this.popbox;0<t.properties.gallery.items.length&&(t.trigger("gallery_change"),(e=x.isNumber(e)?e:t.properties.gallery.current_index)>t.properties.gallery.items.length-1?e=0:e<0&&(e=0<t.properties.gallery.items.length?t.properties.gallery.items.length-1:0),t.properties.gallery.current_index=e,t.update({content:'<div class="popbox-gallery-container" style="overflow:hidden;"><div class="popbox-gallery-image"><img src="'+t.properties.gallery.items[t.properties.gallery.current_index]+'" /></div></div>'},!0),t.on("adjust.gallery_after_change",function(){t.off("adjust.gallery_after_change"),t.trigger("gallery_after_change")}))},o.prototype.next=function(){var e=this.popbox;this.goTo(e.properties.gallery.current_index+1)},o.prototype.prev=function(){var e=this.popbox;this.goTo(e.properties.gallery.current_index-1)},y.Popbox.prototype.gallery=o,x.addHook("initialize",function(){this.gallery=new o(this)}),x.addHook("after_initialize",function(e){var t=this.gallery;"gallery"===this.settings.mode&&(e&&!x.isSet(e.fit)&&(this.base_settings.fit=!0,this._private.applySettings()),t.refreshItems())}),x.addHook("after_reset",function(){this.properties.gallery={items:[],current_index:0}}),x.addHook("after_create",function(){var e=this.gallery;"gallery"===this.settings.mode&&(e._private.attachSwipeEvents(),e._private.attachNavEvents())}),x.addHook("open",function(){var e=this.gallery;if("gallery"===this.settings.mode){e.refreshItems();var t=y("<div/>").html(this.settings.content).find("img[src]"),o=0;t.length&&(o=x.indexOf(t.attr("src"),this.properties.gallery.items,!0)),e.goTo(o)}}),x.addHook("image_error",function(e){var t=this;"gallery"===t.settings.mode&&(t.update({content:t.settings.gallery.error},!1),t.properties.cache.images[e]&&delete t.properties.cache.images[e])}),x.addHook("after_update",function(){var e=this.gallery;this.isOpen()||(this.properties.gallery.items=[],this.properties.gallery.current_index=0),"gallery"===this.settings.mode&&(e.refreshItems(),e.goTo())}),x.addHook("after_update_dom",function(){var e=this,t=!1;"gallery"===e.settings.mode&&(e.elements.$popbox.addClass("popbox-gallery"),1<e.properties.gallery.items.length&&(e.elements.$popbox_gallery_next||(e.elements.$popbox_gallery_next=y("<a/>",{class:"popbox-gallery-next",href:"javascript:void(0);"}).html(e.settings.gallery.next).appendTo(e.elements.$popbox_container)),e.elements.$popbox_gallery_prev||(e.elements.$popbox_gallery_prev=y("<a/>",{class:"popbox-gallery-prev",href:"javascript:void(0);"}).html(e.settings.gallery.prev).appendTo(e.elements.$popbox_container)),t=!0)),t||(e.elements.$popbox_gallery_next&&e.elements.$popbox_gallery_next.remove(),e.elements.$popbox_gallery_prev&&e.elements.$popbox_gallery_prev.remove(),e.elements.$popbox_gallery_next=!1,e.elements.$popbox_gallery_prev=!1)}),y.Popbox.prototype.plugins.gallery="1.1.4"}(jQuery,window);