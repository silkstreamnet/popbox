(function(b){function k(h,a){var d={forceAbsolute:!1,container:window,completeHandler:null,animate:!0};b.extend(d,a);return h.each(function(){var a=b(h),c=b(d.container),e=d.container==window;d.forceAbsolute&&(e?a.remove().appendTo("body"):a.remove().appendTo(c.get(0)));a.css("position","absolute");var f=e?2:1.8,q=(e?c.width():c.outerWidth(false))/2-a.outerWidth(false)/2,e=(e?c.height():c.outerHeight(false))/f-a.outerHeight(false)/2;!0===d.animate?a.stop(!0,!0).animate({left:q+c.scrollLeft(),top:e+c.scrollTop()},500):a.stop(!0,!0).css({left:q+c.scrollLeft(),top:e+c.scrollTop()});d.completeHandler&&d.completeHandler(h)})}b.fn.PopBox=function(h){var a=b.extend({},{transition:!1,width:0,height:0,html:!1,contentid:!1,closeText:"X",onShow:!1,onClose:!1,onStart:!1,onClick:!1},h);a.popbox=!1;var d="",l="",c="",e="X",f="";b(this).click(function(h){if("function"===typeof a.onClick)a.onClick(a);d="number"===typeof a.width&&0<a.width?"width:"+a.width+"px;":"";l="number"===typeof a.height&&0<a.height?"height:"+a.height+"px;":"";c=""!=d||""!=l?d+" "+l:"";e="string"===typeof a.closeText?a.closeText:e;var r='<div class="popbox-cast" style="display:none;height:100%; width: 100%; position:fixed; left: 0; top:0; background-color: rgba(0,0,0,0.4); z-index: 9990;"></div><div class="popbox-popup" style="position:absolute; z-index:9991; visibility:hidden;'+c+'"><a class="popbox-close">'+e+"</a>";f=null!=a.html&&!1!=a.html&&""!=a.html&&"string"===typeof a.html?a.html:f;var i=!1;!1!=a.contentid&&("string"===typeof a.contentid&&""===f)&&(i=b("#"+a.contentid),f=0<i.length?b("<div />").append(b(i).eq(0).clone()).html():f,i.remove());b("body").append(r+f+"</div>");var g=b(".popbox-popup"),m=b(".popbox-cast"),j=!1;a.close=function(){if(!j){if("function"===typeof a.onClose)a.onClose(a);a.popbox=!1;g.fadeOut(500,function(){b(this).remove()});m.fadeOut(500,function(){b(this).remove()});j=!0}};a.popbox=g;if("function"===typeof a.onStart)a.onStart(a);m.fadeIn(300);!1!=a.contentid&&g.find("#"+a.contentid);k(g,{animate:!1});g.css({visibility:"",display:"none"}).fadeIn(300);var n=!1;b(window).resize(function(){!1==n&&(n=!0,setTimeout(function(){k(g);n=!1},500))});var p=!1;b(window).scroll(function(){!1==p&&(p=!0,setTimeout(function(){k(g);p=!1},500))});b(".popbox-cast,.popbox-close").click(function(c){if(!j){if("function"===typeof a.onClose)a.onClose(a);a.popbox=!1;g.fadeOut(500,function(){b(this).remove()});m.fadeOut(500,function(){b(this).remove()});j=!0}c.preventDefault()});if("function"===typeof a.onShow)a.onShow(a);h.preventDefault()})}})(jQuery);
