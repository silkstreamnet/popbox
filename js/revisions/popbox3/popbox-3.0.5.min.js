!function(e,t){function i(e){if(e in n._test_div.style)return e;for(var t=["Moz","Webkit","O","ms"],i=e.charAt(0).toUpperCase()+e.substr(1),o=0;o<t.length;++o){var s=t[o]+i;if(s in n._test_div.style)return s}}var o=function(){},n={$window:e(t),$html:e("html"),$body:e("body"),_event_namespace:"Popbox",_next_instance_id:0,_next_transition_id:0,_instances:{length:0},_support:{},_speeds:{_default:300,fast:300,medium:600,slow:1e3},_eases:{_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeInCubic:"cubic-bezier(.550,.055,.675,.190)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},_transition_end_event_names:{transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},_test_div:document.createElement("div")};n._support.transition=i("transition"),n._support.transform=i("transform"),n._support.transform_origin=i("transformOrigin"),n._support.transition_end=n._transition_end_event_names[n._support.transition]||null,n._test_div=null,n.param=function(e,t){return"undefined"!=typeof e?e:t},n.regexEscape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},n.isSet=function(e){return"undefined"!=typeof e},n.isFunction=function(e){return"function"==typeof e},n.isPlainObject=function(e){return"object"==typeof e&&null!=e&&!(e instanceof Array)},n.isArray=function(e){return"object"==typeof e&&e instanceof Array},n.isNumber=function(e,t){return"number"==typeof e&&(!n.param(t,!1)||e>0)},n.isString=function(e,t){return"string"==typeof e&&(!n.param(t,!1)||""!=e)},n.getAttributeString=function(e,t){var i=e.attr(t);return"undefined"==typeof i||i===!1||""===i?"":i},n.indexOf=function(e,t,i){if(i=i||!1,t instanceof Array)for(var o=0;o<t.length;o++)if(i){if(t[o]===e)return o}else if(t[o]==e)return o;return-1},n.trim=function(e){return n.isString(e)?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):e},n.getInlineStyle=function(e,t){var i=n.getAttributeString(e,"style");if(t&&i){var o=new RegExp("(^|;)\\s*"+n.regexEscape(t)+"\\s*:");if(i.match(o))return e.css(t)}return""},n.splitOutside=function(e,t,i,o){"undefined"==typeof i&&(i=""),"undefined"==typeof o&&(o=i),i instanceof Array||(i=[i]),o instanceof Array||(o=[o]);for(var n=[],s=t.split(e),p=!1,a=0,r=i[a],l=o[a],c=0;c<s.length;c++){for(var _=!1,g=0;g<i.length;g++){r=i[g],l=o[a];var d=r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),m=l.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),u=s[c].match(new RegExp("["+d+"][^"+m+"]*")),h=s[c].match(new RegExp("[^"+d+"]*["+m+"]"));p!==!1?g==a&&(p+=s[c],h?(n.push(p),p=!1):p+=e,_=!0):u&&(p=s[c]+e,a=g<o.length?g:0,_=!0)}_||n.push(s[c])}return n},n.elementPaddingWidth=function(e,t){return e&&e.length?e.outerWidth(!!n.param(t,!1))-e.width():0},n.elementPaddingHeight=function(e,t){return e&&e.length?e.outerHeight(!!n.param(t,!1))-e.height():0},n.transition=function(t,i,o,s,p,a){i=n.param(i,{}),o=n.param(o,n._speeds._default),s=n.param(s,n._eases._default),a=n.isString(a,!0)?a:!1;var r,l=[],c=!1,_=!1,g=n._next_transition_id;if(n._next_transition_id++,n._support.transition_end&&o>25){for(r in i)if(i.hasOwnProperty(r)){l.push(r+" "+o+"ms "+s);var d=t.css(r),m=i[r],u=["width","height","top","right","bottom","left"];n.isString(d,!0)&&(d=d.trim(),d.match(/^[0-9]+(?:\.[0-9]+)?\s*.{0,4}$/)&&(d=parseFloat(d))),n.isString(m,!0)&&(m=m.trim(),m.match(/^[0-9]+(?:\.[0-9]+)?\s*.{0,4}$/)&&(m=parseFloat(m))),n.isNumber(d,!0)&&(d=Math.ceil(d*(n.indexOf(r,u)>-1?1:100))),n.isNumber(m,!0)&&(m=Math.ceil(m*(n.indexOf(r,u)>-1?1:100))),n.isNumber(d)&&n.isNumber(m)?(d-m>1||m-d>1)&&(c=!0):d!=m&&(c=!0)}for(var h=n.splitOutside(",",t.css("transition"),"(",")"),b=0;b<h.length;b++){var f=n.trim(h[b]),v=!1;if(f&&!f.match(/all 0(?:\.[0]+)?[^0-9]/)){for(r in i)if(i.hasOwnProperty(r)&&n.isString(r,!0)&&h[b].match(new RegExp(n.regexEscape(r)))){v=!0;break}v||(l.push(f),c=!0)}}var x=t.hasClass("popbox-animating");l.length&&c&&(t.off(".popbox_auto_transition_end"),n.transitionAddCallback(t,p,a),t.css("transition",l.join(", ")),t.css(i).addClass("popbox-animating"),t.data("popbox-transition-id",g),setTimeout(function(){var i=!1,s=function(){if(t.data("popbox-transition-id")===g){i!==!1&&(clearTimeout(i),i=!1),t.off(".popbox_auto_transition_end"),t.css("transition","").removeClass("popbox-animating");var o=t.data("popbox-transition-end-functions");if(o&&(o=e.extend({},o),t.data("popbox-transition-id",!1),n.clearTransition(t)),o)for(var s in o)if(o.hasOwnProperty(s))for(var p=0;p<o[s].length;p++)n.isFunction(o[s][p])&&o[s][p]()}};t.off(".popbox_auto_transition_end").on(n._support.transition_end+".popbox_auto_transition_end",function(e){e.stopPropagation(),s()}),i=setTimeout(function(){i=!1,s()},o+50)},0),_=!0)}_||(t.css(i),x?n.transitionAddCallback(t,p,a):n.isFunction(p)&&setTimeout(function(){p()},0))},n.transitionAddCallback=function(e,t,i){if(i=n.isString(i,!0)?i:"_default",e.length&&n.isFunction(t)){var o=e.data("popbox-transition-end-functions");o&&o[i]?o[i].push(t):o?o[i]=[t]:(o={},o[i]=[t]),e.data("popbox-transition-end-functions",o)}},n.clearTransition=function(e,t){if(t=n.isString(t,!0)?t:!1){var i=e.data("popbox-transition-end-functions");i&&i[t]&&(delete i[t],e.data("popbox-transition-end-functions",i))}else e.data("popbox-transition-end-functions",!1)},n.getTrueWidth=function(e){return e&&e.length?e.get(0).getBoundingClientRect().right-e.get(0).getBoundingClientRect().left:0},n.getTrueHeight=function(e){return e&&e.length?e.get(0).getBoundingClientRect().bottom-e.get(0).getBoundingClientRect().top:0},n.offTouchClick=function(e){e.length&&e.off(".Popbox_touch_click")},n.onTouchClick=function(t,i,o,s){if(t.length){var p="Popbox_touch_click";s&&t.on("click."+p,function(e){e.preventDefault()}),t.on("mousedown."+p+" touchstart."+p,i,function(t){if(t.originalEvent.touches||1==t.which){var i=e(this);i.off("mouseup."+p+" touchend."+p).on("mouseup."+p+" touchend."+p,function(e){(t.originalEvent.touches||1==t.which)&&(s&&e.preventDefault(),n.isFunction(o)&&o.call(this,e))})}})}},o.prototype.reset=function(){var e=this.self;e._private.triggerHook("reset"),e.trigger("reset"),e.properties.disable_background_click_timer!==!1&&clearTimeout(e.properties.disable_background_click_timer),e.properties={is_open:!1,is_loading:!1,is_changing_state:!1,disable_background_click:!1,disable_background_click_timer:!1,image_cache:{},interface_image_cache_pending:0,content_image_cache_pending:0,last_html_overflow:!1,last_html_margin_right:!1,instance_id:e.properties.instance_id,events:e.properties.events},e.elements={$popbox:null,$popbox_loading:null,$popbox_popup:null,$popbox_empty:null,$popbox_wrapper:null,$popbox_container:null,$popbox_title:null,$popbox_close:null,$popbox_content:null,$popbox_overlay:e.elements.$popbox_overlay},e._private.triggerHook("after_reset"),e.trigger("after_reset")},o.prototype.createOverlay=function(){var t=this.self,i=t.settings.container?e(t.settings.container):n.$body,o=i.children(".popbox-overlay");o.length?t.elements.$popbox_overlay=o:t.elements.$popbox_overlay=e("<div/>",{"class":"popbox-overlay",css:{display:"none",position:"fixed",top:"0",right:"0",bottom:"0",left:"0"}}).data("is_open",!1).appendTo(i),t.elements.$popbox_overlay.off("click.popbox_overlay_close").on("click.popbox_overlay_close",function(e){e.preventDefault();for(var i in n._instances)n._instances.hasOwnProperty(i)&&n._instances[i]instanceof s&&n._instances[i].isOpen()&&n._instances[i].close();t._private.closeOverlay()})},o.prototype.destroyOverlay=function(){var e=this.self;n._instances.length<=0&&e.elements.$popbox_overlay&&(e.elements.$popbox_overlay.remove(),e.elements.$popbox_overlay=null)},o.prototype.openOverlay=function(){var e=this.self;e.elements.$popbox_overlay||e._private.createOverlay(),e.elements.$popbox_overlay.data("is_open")===!1&&(e.elements.$popbox_overlay.css({display:"block",opacity:"0"}),n.clearTransition(e.elements.$popbox_overlay),n.transition(e.elements.$popbox_overlay,{opacity:"1"},e._private.getOverlayAnimationSpeed("open"),e._private.getOverlayAnimationEase("open")),e.elements.$popbox_overlay.data("is_open",!0))},o.prototype.closeOverlay=function(){var e=this.self;e.elements.$popbox_overlay&&(e.elements.$popbox_overlay.data("is_open")===!0?(n.clearTransition(e.elements.$popbox_overlay),n.transition(e.elements.$popbox_overlay,{opacity:"0"},e._private.getOverlayAnimationSpeed("close"),e._private.getOverlayAnimationEase("close"),function(){e.elements.$popbox_overlay&&e.elements.$popbox_overlay.css({display:"none"}),e._private.destroyOverlay()}),e.elements.$popbox_overlay.data("is_open",!1)):e.elements.$popbox_overlay.hasClass("popbox-animating")||e._private.destroyOverlay())},o.prototype.getAnimationStartProperties=function(e){var t=this.self;return n.isSet(t.animations[t.settings.animation])?t.animations[t.settings.animation][e][0]:t.animations.fade[e][0]},o.prototype.getAnimationEndProperties=function(e){var t=this.self;return n.isSet(t.animations[t.settings.animation])?t.animations[t.settings.animation][e][t.animations[t.settings.animation][e].length-1]:t.animations.fade[e][t.animations.fade[e].length-1]},o.prototype.getAnimationSpeed=function(e){var t=this.self;return t.settings[e+"_animation_speed"]||t.settings.animation_speed||n._speeds._default},o.prototype.getAnimationEase=function(e){var t=this.self;return t.settings[e+"_animation_ease"]||t.settings.animation_ease||n._eases._default},o.prototype.getOverlayAnimationSpeed=function(e){var t=this.self;return t.settings[e+"_overlay_animation_speed"]===!0?t._private.getAnimationSpeed(e):t.settings[e+"_overlay_animation_speed"]||t.settings.overlay_animation_speed||t._private.getAnimationSpeed(e)},o.prototype.getOverlayAnimationEase=function(e){var t=this.self;return t.settings[e+"_overlay_animation_ease"]===!0?t._private.getAnimationEase(e):t.settings[e+"_overlay_animation_ease"]||t.settings.overlay_animation_ease||t._private.getAnimationEase(e)},o.prototype.checkImagesLoaded=function(){var t=this.self;if(t.isCreated()){t.properties.content_image_cache_pending=0,t.properties.interface_image_cache_pending=0;var i=t.elements.$popbox.find("img");i.each(function(){var i=this,o=e(this);if(i.src){var s=i.complete&&n.isNumber(i.naturalWidth,!1)||4===i.readyState||"complete"===i.readyState;s||t.properties.image_cache[i.src]||(t.properties.image_cache[i.src]={origin:i,$origin:o,proxy:!1,loaded:!1,type:o.closest(t.elements.$popbox_content).length>0?"content":"interface"})}});var o=function(e){"content"===e?(t.properties.content_image_cache_pending--,t.properties.content_image_cache_pending<=0&&(t.properties.content_image_cache_pending=0,t.isChangingState()&&t.elements.$popbox_popup.hasClass("popbox-animating")?n.transitionAddCallback(t.elements.$popbox_popup,function(){t.adjust(!0)}):t.adjust(!0))):(t.properties.interface_image_cache_pending--,t.properties.interface_image_cache_pending<=0&&(t.properties.interface_image_cache_pending=0))};for(var s in t.properties.image_cache)t.properties.image_cache.hasOwnProperty(s)&&(t.properties.image_cache[s].proxy?t.properties.image_cache[s].loaded||("content"===t.properties.image_cache[s].type?t.properties.content_image_cache_pending++:t.properties.interface_image_cache_pending++):!function(e){var i=new Image;"content"===t.properties.image_cache[e].type?t.properties.content_image_cache_pending++:t.properties.interface_image_cache_pending++,t.properties.image_cache[e].proxy=i,i.onload=function(){t.properties.image_cache[e].loaded||(t.properties.image_cache[e].loaded=!0,o(t.properties.image_cache[e].type),t._private.triggerHook("image_load",[e]),t.trigger("image_load",!1,[e]))},i.onerror=function(){t.properties.image_cache[e].loaded||(t.properties.image_cache[e].loaded=!0,o(t.properties.image_cache[e].type),t._private.triggerHook("image_error",[e]),t.trigger("image_error",!1,[e]))},i.src=e}(s));if(0==t.properties.content_image_cache_pending&&0==t.properties.interface_image_cache_pending)return!0}return!1},o.prototype.applyDomSettings=function(){var e=this.self;if(e.isCreated()){e._private.triggerHook("update_dom"),e.trigger("update_dom"),e.elements.$popbox_loading.html(e.settings.loading_text),e.elements.$popbox_close.html(e.settings.close_text),e.elements.$popbox_title.html(e.settings.title),n.isFunction(e.settings.content.appendTo)?(e.elements.$popbox_content.html(""),e.settings.content.appendTo(e.elements.$popbox_content)):e.elements.$popbox_content.html(e.settings.content),n.isString(e.settings.add_class,!0)&&e.elements.$popbox.addClass(e.settings.add_class),e.settings.aspect_fit?e.elements.$popbox.addClass("popbox-aspect-fit"):e.elements.$popbox.removeClass("popbox-aspect-fit"),e.settings.close_text===!1?e.elements.$popbox_close.css("display","none"):e.elements.$popbox_close.css("display","block"),e.settings.title===!1?e.elements.$popbox_title.css("display","none"):e.elements.$popbox_title.css("display","block"),n.isNumber(e.settings.z_index,!0)&&(e.elements.$popbox_overlay.css("z-index",e.settings.z_index),e.elements.$popbox.css("z-index",e.settings.z_index+1),e.elements.$popbox_popup.css("z-index",e.settings.z_index+2));var t={mobile:navigator.userAgent.match(/(iPad|iPhone|iPod|Android)/g),ios:navigator.userAgent.match(/(iPad|iPhone|iPod)/g),android:navigator.userAgent.match(/(Android)/g)};e.settings.absolute===!0||n.isString(e.settings.absolute)&&t[e.settings.absolute]?e.elements.$popbox.css({position:"absolute","overflow-y":"visible","overflow-x":"visible"}):e.elements.$popbox.css({position:"fixed","overflow-y":"scroll","overflow-x":"hidden"}),e._private.triggerHook("after_update_dom"),e.trigger("after_update_dom")}},o.prototype.triggerHook=function(e,t){var i=this.self;if(t=n.isArray(t)?t:[],n.isPlainObject(i.hooks)&&n.isArray(i.hooks[e]))for(var o=0;o<i.hooks[e].length;o++)n.isFunction(i.hooks[e][o])&&i.hooks[e][o].apply(i,t)};var s=function(t){var i=this;i._private=new o,i._private.self=i,i._private.triggerHook("initialize",[t]),i.settings=e.extend(!0,{},i.default_settings,n.param(t,{})),i.properties={instance_id:n._next_instance_id,events:{}},i.elements={$popbox_overlay:null},i._private.reset(),n._next_instance_id++,i.trigger("initialize",!1,[t]),i._private.triggerHook("after_initialize",[t]),i.trigger("after_initialize",!1,[t])};s.prototype.version="3.0.4",s.prototype.plugins={},s.prototype.default_settings={width:!1,height:!1,min_width:100,min_height:100,max_width:!1,max_height:!1,container:!1,animation:"fade",animation_speed:n._speeds._default,animation_ease:n._eases._default,open_animation:null,open_animation_speed:null,open_animation_ease:null,close_animation:null,close_animation_speed:null,close_animation_ease:null,overlay_animation_speed:null,overlay_animation_ease:null,open_overlay_animation_speed:null,open_overlay_animation_ease:null,close_overlay_animation_speed:null,close_overlay_animation_ease:null,content:"",close_text:"X",title:!1,hide_page_scroll:!0,hide_page_scroll_space:!0,content_additional_offset:!1,loading_text:"Loading",absolute:"mobile",add_class:"",aspect_fit:!1,cache:!1,wait_for_images:!0,width_margin:.1,height_margin:.08,z_index:99900,mode:!1,open:!1,after_open:!1,close:!1,after_close:!1},s.prototype._static=n,s.prototype.animations={fade:{open:[{opacity:"0"},{opacity:"1"}],close:[{opacity:"1"},{opacity:"0"}]}},s.prototype.hooks={},n.addHook=function(e,t){n.isArray(s.prototype.hooks[e])||(s.prototype.hooks[e]=[]),s.prototype.hooks[e].push(t)},s.prototype.create=function(){var t=this;t.destroy(),t._private.triggerHook("create"),t._private.createOverlay();var i=t.settings.container?e(t.settings.container):n.$body;t.elements.$popbox=e("<div/>",{"class":"popbox",css:{display:"none",position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px","overflow-y":"scroll","overflow-x":"hidden"}}),t.elements.$popbox_empty=e("<div/>",{"class":"popbox-empty",css:{display:"block",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}}).appendTo(t.elements.$popbox),t.elements.$popbox_popup=e("<div/>",{"class":"popbox-popup",css:{display:"none",position:"absolute",top:"50%",left:"50%",bottom:"auto",right:"auto",width:"0px",height:"0px"}}).appendTo(t.elements.$popbox),t.elements.$popbox_loading=e("<div/>",{"class":"popbox-loading",css:{display:"none"}}).appendTo(t.elements.$popbox_popup),t.elements.$popbox_wrapper=e("<div/>",{"class":"popbox-wrapper"}).appendTo(t.elements.$popbox_popup),t.elements.$popbox_container=e("<div/>",{"class":"popbox-container"}).appendTo(t.elements.$popbox_wrapper),t.elements.$popbox_title=e("<div/>",{"class":"popbox-title"}).appendTo(t.elements.$popbox_container),t.elements.$popbox_content=e("<div/>",{"class":"popbox-content"}).appendTo(t.elements.$popbox_container),t.elements.$popbox_close=e("<a/>",{"class":"popbox-close",href:"javascript:void(0);"}).appendTo(t.elements.$popbox_container),t._private.applyDomSettings(),t.elements.$popbox_close.off("click.popbox_close").on("click.popbox_close",function(e){e.preventDefault(),t.close()});var o="Popbox_complex_close";t.elements.$popbox.on("mousedown."+n._event_namespace+" touchstart."+n._event_namespace,function(i){var n=i.originalEvent.touches&&i.originalEvent.touches[0]?i.originalEvent.touches[0].pageX:i.pageX,s=i.originalEvent.touches&&i.originalEvent.touches[0]?i.originalEvent.touches[0].pageY:i.pageY;(i.originalEvent.touches||1==i.which)&&0===e(i.target).closest(".popbox-popup").length&&n<t.elements.$popbox_empty.width()&&(t.elements.$popbox.off("."+o),t.elements.$popbox.on("mouseup."+o+" touchend."+o,function(n){return!n.originalEvent.touches&&1!=n.which||(t.elements.$popbox.off("."+o),t.properties.disable_background_click||i.target!==n.target||0!==e(n.target).closest(".popbox-popup").length)?void 0:(n.preventDefault(),t.close(),!1)}),t.elements.$popbox.on("mousemove."+o+" touchmove."+o,function(e){var i=e.originalEvent.touches&&e.originalEvent.touches[0]?e.originalEvent.touches[0].pageX:e.pageX,p=e.originalEvent.touches&&e.originalEvent.touches[0]?e.originalEvent.touches[0].pageY:e.pageY;(n-5>i||i>n+5||s-5>p||p>s+5)&&t.elements.$popbox.off("."+o)}),t.elements.$popbox.on("scroll."+o,function(){t.elements.$popbox.off("."+o)}))}),t.elements.$popbox.appendTo(i),n._instances[t.properties.instance_id]=t,n._instances.length++,t._private.triggerHook("after_create")},s.prototype.destroy=function(){var e=this;e.elements.$popbox&&(e._private.triggerHook("destroy"),e.elements.$popbox.remove(),e.elements.$popbox=null,n.isSet(n._instances[e.properties.instance_id])&&(delete n._instances[e.properties.instance_id],n._instances.length--),e._private.closeOverlay(),e._private.reset(),e._private.triggerHook("after_destroy"))},s.prototype.update=function(t,i){var o=this;i=n.param(i,!0),e.extend(!0,o.settings,n.param(t,{})),o.isCreated()&&(o.isOpen()?i?o.showLoading(function(){o._private.applyDomSettings(),o.adjust(!0)}):(o._private.applyDomSettings(),o.adjust(!1)):o._private.applyDomSettings())},s.prototype.open=function(){var e=this;if(!e.isOpen()){if(e.elements.$popbox?e._private.applyDomSettings():e.create(),e._private.triggerHook("open"),e.trigger("open"),"absolute"==e.elements.$popbox.css("position"))e.elements.$popbox.css("top",n.$window.scrollTop()+"px");else if(e.settings.hide_page_scroll){var t=n.$body.width();e.properties.last_html_overflow===!1&&(e.properties.last_html_overflow=n.getInlineStyle(n.$html,"overflow")),n.$html.addClass("popbox-hide-page-scroll").css("overflow","hidden");var i=n.$body.width();e.settings.hide_page_scroll_space&&(e.properties.last_html_margin_right===!1&&(e.properties.last_html_margin_right=n.getInlineStyle(n.$html,"margin-right")),i>t&&n.$html.css("margin-right",i-t+"px"))}e._private.openOverlay(),e.elements.$popbox_popup.css({display:"block","box-sizing":"content-box"}),e.elements.$popbox.css({display:"block","box-sizing":"content-box"}),e.elements.$popbox_popup.css({visibility:"visible","box-sizing":"content-box"}),e.properties.is_loading||e.showContent(),e.adjust(!1),e.elements.$popbox_popup.css(e._private.getAnimationStartProperties("open")),n.clearTransition(e.elements.$popbox_popup),e.properties.is_changing_state=!0,n.transition(e.elements.$popbox_popup,e._private.getAnimationEndProperties("open"),e._private.getAnimationSpeed("open"),e._private.getAnimationEase("open"),function(){e.properties.is_changing_state=!1}),e.elements.$popbox_popup.hasClass("popbox-animating")&&(e.properties.disable_background_click=!0,e.properties.disable_background_click_timer=setTimeout(function(){e.properties.disable_background_click=!1,e.properties.disable_background_click_timer=!1},e._private.getAnimationSpeed("open")+200)),e.properties.is_open=!0,e._private.triggerHook("after_open"),e.trigger("after_open")}},s.prototype.close=function(e){var t=this;if(t.isOpen()){t._private.triggerHook("close"),t.trigger("close"),t.properties.is_open=!1;for(var i in t.elements)t.elements.hasOwnProperty(i)&&t.elements[i].length&&n.clearTransition(t.elements[i]);t.elements.$popbox_popup.css(t._private.getAnimationStartProperties("close")),t.properties.is_changing_state=!0,n.transition(t.elements.$popbox_popup,t._private.getAnimationEndProperties("close"),t._private.getAnimationSpeed("close"),t._private.getAnimationEase("close"),function(){t.properties.is_changing_state=!1,t.elements.$popbox.css({display:"none"}),t.properties.last_html_overflow!==!1&&n.$html.css("overflow",t.properties.last_html_overflow),t.properties.last_html_margin_right!==!1&&n.$html.css("margin-right",t.properties.last_html_margin_right),t.properties.last_html_overflow=!1,t.properties.last_html_margin_right=!1,n.$html.removeClass("popbox-hide-page-scroll"),e||!t.settings.cache?t.destroy():(t.elements.$popbox_popup.css(t._private.getAnimationEndProperties("open")),t.properties.disable_background_click=!1,t.properties.disable_background_click_timer!==!1&&(clearTimeout(t.properties.disable_background_click_timer),t.properties.disable_background_click_timer=!1)),t._private.triggerHook("after_close"),t.trigger("after_close")})}t._private.closeOverlay()},s.prototype.adjust=function(t){var i=this;if(t=n.param(t,!0),i.isCreated()){var o=function(t,o){t=n.param(t,!1),o=n.param(o,!1);var s,p,a,r,l=i.elements.$popbox_empty.width(),c=n.$window.height(),_=n.elementPaddingWidth(i.elements.$popbox_popup),g=n.elementPaddingHeight(i.elements.$popbox_popup),d=n.elementPaddingWidth(i.elements.$popbox_content,!0),m=n.elementPaddingHeight(i.elements.$popbox_content,!0),u=(i.settings.width_margin>0?l-2*l*i.settings.width_margin:l)-_,h=(i.settings.height_margin>0?c-2*c*i.settings.height_margin:c)-g,b=0,f=0,v=n.isNumber(i.settings.width)?i.settings.width+"px":"auto",x=n.isNumber(i.settings.height)?i.settings.height+"px":"auto",y=h;n.isNumber(i.settings.max_width,!0)&&u>i.settings.max_width&&(u=i.settings.max_width),n.isNumber(i.settings.max_height,!0)&&h>i.settings.max_height&&(h=i.settings.max_height),n.isNumber(i.settings.min_width,!0)&&b<i.settings.min_width&&(b=i.settings.min_width),n.isNumber(i.settings.min_height,!0)&&f<i.settings.min_height&&(f=i.settings.min_height),i.elements.$popbox_content.css({height:"","overflow-y":"","box-sizing":"content-box"}),i.elements.$popbox_wrapper.css({position:"relative",top:"0px",left:"0px",width:i.settings.aspect_fit?"99999px":u+"px",height:i.settings.aspect_fit?"99999px":"1px",overflow:"hidden","box-sizing":"content-box"}),i.elements.$popbox_container.css({position:"absolute",top:"0px",left:"0px",width:v,height:x,"min-width":i.settings.min_width===!0?"100%":b+"px","min-height":i.settings.min_height===!0?"100%":f+"px","max-width":"100%","box-sizing":"content-box"}),s=Math.ceil(100*n.getTrueWidth(i.elements.$popbox_container))/100,p=Math.ceil(100*n.getTrueHeight(i.elements.$popbox_container))/100;var $=function(t){t=t||!1;var o=p-m,s=i.settings.content_additional_offset;if(o-=i.elements.$popbox_content.offset().top-i.elements.$popbox_container.offset().top,n.isNumber(s)?o+=s:s=[s],s instanceof Array)for(var a=0;a<s.length;a++)if(n.isString(s[a],!0)){var r=0;e(s[a]).each(function(){var t=e(this),o=t.offset().top+t.outerHeight(!0)-(i.elements.$popbox_content.offset().top+i.elements.$popbox_content.outerHeight(!0));o>0&&o>r&&(r=o)})}i.elements.$popbox_content.css({height:t?Math.floor(o)+"px":o+"px","overflow-y":t?"scroll":"hidden"})};if(i.settings.aspect_fit){if(s>u||p>h){var w=(h-m)/(u-d),k=(p-m)/(s-d);k>w?(s=(s-d)*((h-m)/(p-m))+d,p=h):(p=(p-m)*((u-d)/(s-d))+m,s=u),$(!1)}}else(i.settings.max_height===!0||n.isNumber(i.settings.max_height,!0))&&p>h?(p=h,$(!0)):$(!1);var O=function(){i.elements.$popbox_wrapper.css({position:"",top:"",left:"",width:"",height:"",overflow:""}),i.elements.$popbox_container.css({position:"",top:"",left:"",width:"",height:"","min-width":"","min-height":"","max-width":""})};r=(l-(s+_))/2,a=(c-(p+g))/2,p>y&&(a=i.settings.height_margin>0?c*i.settings.height_margin:0),t?(n.clearTransition(i.elements.$popbox_popup,"adjust"),n.transition(i.elements.$popbox_empty,{height:Math.floor(p+g+2*a-1)+"px"},n._speeds.fast,n._eases.easeInOutQuad),n.transition(i.elements.$popbox_popup,{width:s+"px",height:p+"px",top:a+"px",left:r+"px"},n._speeds.fast,n._eases.easeInOutQuad,function(){O(),o&&i.showContent()},"adjust")):(O(),i.elements.$popbox_popup.css({width:s+"px",height:p+"px",top:a+"px",left:r+"px"}),i.elements.$popbox_empty.css({height:Math.floor(p+g+2*a-1)+"px"}))};i._private.checkImagesLoaded(),i.settings.wait_for_images&&i.properties.content_image_cache_pending>0?i.showLoading(function(){t||o(t,!1)}):t?i.showLoading(function(){o(t,!0)}):o(!1,!0)}},s.prototype.showLoading=function(e){var t=this;if(t.isCreated()){if(t.isLoading())return void(t.elements.$popbox_loading.hasClass("popbox-animating")||t.elements.$popbox_wrapper.hasClass("popbox-animating")||!n.isFunction(e)||e());t.isOpen()?(n.clearTransition(t.elements.$popbox_loading),n.clearTransition(t.elements.$popbox_wrapper),n.transition(t.elements.$popbox_wrapper,{opacity:"0"},n._speeds.fast,"linear",function(){t.elements.$popbox_wrapper.css({visibility:"hidden"}),t.elements.$popbox_loading.css({opacity:"0",display:"block"}),n.transition(t.elements.$popbox_loading,{opacity:"1"},n._speeds.fast,"linear",function(){n.isFunction(e)&&e()})})):(t.elements.$popbox_wrapper.css({opacity:"0",visibility:"hidden"}),t.elements.$popbox_loading.css({opacity:"1",display:"block"}),n.isFunction(e)&&e()),t.properties.is_loading=!0}},s.prototype.showContent=function(e){var t=this;if(t.isCreated()){if(!t.isLoading())return void(t.elements.$popbox_popup.hasClass("popbox-animating")||t.elements.$popbox_loading.hasClass("popbox-animating")||t.elements.$popbox_wrapper.hasClass("popbox-animating")||!n.isFunction(e)||e());t.isOpen()?(n.clearTransition(t.elements.$popbox_loading),n.clearTransition(t.elements.$popbox_wrapper),n.transition(t.elements.$popbox_loading,{opacity:"0"},n._speeds.fast,"linear",function(){t.elements.$popbox_loading.css({display:"none"}),t.elements.$popbox_wrapper.css({opacity:"0",visibility:"visible"}),n.transition(t.elements.$popbox_wrapper,{opacity:"1"},n._speeds.fast,"linear",function(){n.isFunction(e)&&e()})})):(t.elements.$popbox_loading.css({display:"none",opacity:"0"}),t.elements.$popbox_wrapper.css({opacity:"1",visibility:"visible"}),n.isFunction(e)&&e()),t.properties.is_loading=!1}},s.prototype.isLoading=function(){var e=this;return e.properties.is_loading},s.prototype.isOpen=function(){var e=this;return e.properties.is_open},s.prototype.isChangingState=function(){var e=this;return e.properties.is_changing_state},s.prototype.isCreated=function(){var e=this;return!!e.elements.$popbox},s.prototype.on=function(e,t){var i=this,o=e.split(".",2);if(o.length){var s=o[0],p=o[1]?o[1]:"_default";n.isPlainObject(i.properties.events[s])||(i.properties.events[s]={}),n.isArray(i.properties.events[s][p])||(i.properties.events[s][p]=[]),i.properties.events[s][p].push(t)}},s.prototype.off=function(e,t){var i=this,o=e.split(".",2);if(o.length){var s=o[0],p=o[1]?o[1]:!1;if(n.isPlainObject(i.properties.events[s]))for(var a in i.properties.events[s])if(i.properties.events[s].hasOwnProperty(a)&&n.isArray(i.properties.events[s][a])&&(p===!1||p===a))if(n.isFunction(t))for(var r=0;r<i.properties.events[s][a].length;r++)i.properties.events[s][a][r]===t&&(i.properties.events[s][a].splice(r,1),r--);else i.properties.events[s][a]=[]}},s.prototype.trigger=function(e,t,i){var o=this;i=n.isArray(i)?i:[];var s=e.split(".",2);if(s.length){var p=s[0],a=s[1]?s[1]:!1;if(n.isFunction(o.settings[p])&&o.settings[p](),n.isPlainObject(o.properties.events[p]))for(var r in o.properties.events[p])if(o.properties.events[p].hasOwnProperty(r)&&n.isArray(o.properties.events[p][r])&&(a===!1||a===r))for(var l=0;l<o.properties.events[p][r].length;l++)!n.isFunction(o.properties.events[p][r][l])||n.isFunction(t)&&o.properties.events[p][r][l]!==t||o.properties.events[p][r][l].apply(o,i)}},n.$window.on("resize."+n._event_namespace,function(){if(n._instances.length>0)for(var e in n._instances)n._instances.hasOwnProperty(e)&&n._instances[e]instanceof s&&n._instances[e].isOpen()&&n._instances[e].adjust(!1)}),e.Popbox=s}(jQuery,window);