!function(e,r){!function(){for(var r="3.0.0".split("."),t=0,l=e.Popbox.prototype.version.split(".").length;l>t;t++)if(e.Popbox.prototype.version.split(".")[t]<r[t])return void console.log("Error: Popbox "+r.join(".")+"+ required.")}();var t=e.Popbox.prototype._static,l={gallery:{selector:"",clickable:!0,error:'<div class="popbox-gallery-error">There was an error loading the image.</div>',next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>"}};e.extend(!0,e.Popbox.prototype.default_settings,l);var o=function(){};o.prototype.updateItems=function(){var r=this.self;if(r.settings.gallery.selector){var l=e(r.settings.gallery.selector);l.each(function(){var l=e(this),o=l.attr("href"),p=l.attr("src"),i=!1;o?i=o:p?i=p:(l.find("a[href]").each(function(){var l=e(this).attr("href");l&&!l.match(/^#/)&&t.indexOf(l,r.properties.gallery.items,!0)<0&&r.properties.gallery.items.push(l)}),l.find("img[src]").each(function(){var l=e(this).attr("src");l&&t.indexOf(l,r.properties.gallery.items,!0)<0&&r.properties.gallery.items.push(l)})),i&&t.indexOf(i,r.properties.gallery.items,!0)<0&&r.properties.gallery.items.push(i)}),r.settings.gallery.clickable&&l.off("click.popbox_gallery_open").on("click.popbox_gallery_open",function(l){l.preventDefault();var o=e(this),p=o.attr("href"),i=o.attr("src");if(r.gallery.updateItems(),p)r.gallery.goTo(t.indexOf(p,r.properties.gallery.items,!0));else if(i)r.gallery.goTo(t.indexOf(i,r.properties.gallery.items,!0));else{var a=o.find("a[href]:first").attr("href"),s=o.find("img[src]:first").attr("src");a&&!a.match(/^#/)?r.gallery.goTo(t.indexOf(a,r.properties.gallery.items,!0)):s&&r.gallery.goTo(t.indexOf(s,r.properties.gallery.items,!0))}r.open()})}},o.prototype.goTo=function(e){var r=this.self;e=t.isNumber(e)?e:r.properties.gallery.current_index,r.properties.gallery.items.length>0&&(-1>e||e>r.properties.gallery.items.length-1?e=0:0>e&&(e=r.properties.gallery.items.length>0?r.properties.gallery.items.length-1:0),r.properties.gallery.current_index=e,r.update({content:'<img src="'+r.properties.gallery.items[r.properties.gallery.current_index]+'" />'},!0))},o.prototype.next=function(){var e=this.self;e.gallery.goTo(e.properties.gallery.current_index+1)},o.prototype.prev=function(){var e=this.self;e.gallery.goTo(e.properties.gallery.current_index-1)},e.Popbox.prototype.gallery=o,t.addHook("initialize",function(){var e=this;e.gallery=new o,e.gallery.self=e}),t.addHook("after_initialize",function(e){var r=this;"gallery"==r.settings.mode&&e&&!t.isSet(e.aspect_fit)&&(r.settings.aspect_fit=!0),r.gallery.updateItems()}),t.addHook("after_reset",function(){var e=this;e.properties.gallery={items:[],current_index:0}}),t.addHook("open",function(){var r=this;if("gallery"==r.settings.mode){r.gallery.updateItems();var l=e("<div/>").html(r.settings.content).find("img[src]"),o=-1;l.length&&(o=t.indexOf(l.attr("src"),r.properties.gallery.items,!0)),r.gallery.goTo(o)}}),t.addHook("image_error",function(e){var r=this;"gallery"==r.settings.mode&&(r.update({content:r.settings.gallery.error},!1),r.properties.image_cache[e]&&delete r.properties.image_cache[e])}),t.addHook("after_update",function(){var e=this;e.isOpen()||(e.properties.gallery.items=[],e.properties.gallery.current_index=0),"gallery"==e.settings.mode&&(e.gallery.updateItems(),e.gallery.goTo())}),t.addHook("after_update_dom",function(){var r=this,t=!1;"gallery"===r.settings.mode&&r.properties.gallery.items.length>1&&(r.elements.$popbox_gallery_next||(r.elements.$popbox_gallery_next=e("<a/>",{"class":"popbox-gallery-next",href:"javascript:void(0);"}).html(r.settings.gallery.next).appendTo(r.elements.$popbox_container)),r.elements.$popbox_gallery_prev||(r.elements.$popbox_gallery_prev=e("<a/>",{"class":"popbox-gallery-prev",href:"javascript:void(0);"}).html(r.settings.gallery.prev).appendTo(r.elements.$popbox_container)),r.elements.$popbox_gallery_next.off("click.popbox_gallery_next").on("click.popbox_gallery_next",function(e){e.preventDefault(),r.gallery.next()}),r.elements.$popbox_gallery_prev.off("click.popbox_gallery_prev").on("click.popbox_gallery_prev",function(e){e.preventDefault(),r.gallery.prev()}),t=!0),t||(r.elements.$popbox_gallery_next&&r.elements.$popbox_gallery_next.remove(),r.elements.$popbox_gallery_prev&&r.elements.$popbox_gallery_prev.remove(),r.elements.$popbox_gallery_next=!1,r.elements.$popbox_gallery_prev=!1)}),e.Popbox.prototype.plugins.gallery="1.0.0"}(jQuery,window);