!function(t){function e(t,e){return"undefined"!=typeof t?t:e}function o(t,o){return o=e(o,!1),!isNaN(t-0)&&null!=t&&""!=t&&(!o||t>0)}function i(t,o){return o=e(o,!1),"string"==typeof t&&null!=t&&(!o||""!=t)}function n(e,o){if(e.properties.animating)switch(e.properties.animating=!1,o){case"close":e.container.remove(),e.container=!1,e.properties.isopen=!1,e.popup=!1,e.shadow=!1,t("body").css({overflow:e.properties.bodyOverflow,"margin-right":e.properties.bodyMarginRight}),t(document).off("scroll.popbox touchmove.popbox mousewheel.popbox");break;case"open":e.properties.isopen=!0}}function s(t,o){t=e(t,!1),o=e(o,!1);var i=!0;if(t&&t.popup){var n=t.popup.find("img");n.length>0&&n.each(function(t,e){e.complete||4===e.readyState||"complete"===e.readyState||(i=!1)})}return"gallery"==t.settings.mode&&(i?(t.content_area.css({visibility:"",height:"",overflow:""}),t.gallery_loading&&t.gallery_loading.hide()):(t.content_area.css({visibility:"hidden",height:"0",overflow:"hidden"}),t.gallery_loading&&t.gallery_loading.show())),i&&o&&d(t),i}function p(t){if(t=e(t,!1),t&&t.popup){var o=t.popup.find("img");if(o.length>0){var i=0;o.each(function(e,o){o.complete||4===o.readyState||"complete"===o.readyState?i++:"undefined"!=typeof o.onload?o.onload=function(){"undefined"!=typeof o.readyState?setTimeout(function(){s(t,!0)},10):s(t,!0)}:"undefined"!=typeof o.onreadystatechange&&(o.onreadystatechange=function(){setTimeout(function(){s(t,!0)},10)})}),o.length==i&&s(t,!0)}}}function a(t){t.properties.loaded_content!==t.settings.content&&(s(t)||p(t),t.properties.loaded_content=t.settings.content)}function r(e){var o=t("body"),i="popbox-rsc-clone",n=e.container.clone().stop(!0,!0).addClass(i).css({display:"block",visibility:"hidden","z-index":"-1",overflow:"hidden"});n.find("iframe").attr("src",""),n.appendTo(o);var s=o.find("."+i);return{container:s,popup:s.find(".popbox-popup").eq(0),content:s.find(".popbox-content").eq(0)}}function c(t){t&&t.container&&t.container.remove()}function d(t,i){if(i=e(i,!1),t=e(t,!1),t&&t.popup){var n=t.settings,s=t.popup,p=t.container,a=t.content_area;s.stop(!0,!1);var d=0,l=0,h=0,u=0,g=0,f=0,m=0,x=0,b=p.outerWidth(!1),y=p.outerHeight(!1),v=0,w=0,_=0,S=!1,O=!1;if(n.autoScale){if(O=r(t),O.popup.css({height:"auto",width:"auto",top:"auto",left:"auto"}),O.content.attr("style",""),O.content.find("img").css({"max-width":"none",height:"auto",display:"block"}),O.content.find("iframe").css({"max-height":"none","max-width":"none"}),g=O.popup.width(),f=O.popup.height(),m=O.popup.outerWidth(!1)-g,x=O.popup.outerHeight(!1)-f,c(O),v=.8*b-m,w=.8*y-x,f>w||g>v){var k=w/v,z=f/g,C=1;z>k?(C=w/f,l=w,d=g*C):(C=v/g,d=v,l=f*C)}else d=g,l=f;s.find("img").css({"max-width":"100%",height:"auto",display:"block"}),s.find("iframe").css({"max-height":"100%","max-width":"100%"})}else{v=.8*b,w=.8*y,m=s.outerWidth(!1)-s.width(),x=s.outerHeight(!1)-s.height(),d=v-m,l=w-x,o(n.width)?d=n.width:o(n.maxwidth)&&d>n.maxwidth&&(d=n.maxwidth),O=r(t),O.popup.css({height:"auto",width:d,top:"0",left:"0"}),O.content.attr("style",""),o(n.height)?l=n.height:o(n.maxheight)&&l>n.maxheight?l=n.maxheight:n.innerOverflow||(l=O.popup.height()),0==parseInt(O.content.css("margin-top"))&&O.content.css({"margin-top":"-1px",top:"1px"});var I=O.content.outerHeight(!0),j=I-O.content.height(),N=parseInt(O.popup.css("padding-top")),D=parseInt(O.popup.css("border-top-width")),H=parseInt(O.popup.css("margin-top"));isNaN(N)&&(N=0),isNaN(D)&&(D=0),isNaN(H)&&(H=0);var M=N+D+H,R=l-(O.content.position().top-M);i===!0&&n.animateSpeed>0?a.stop(!0,!1).height(a.height()).animate({height:R-j},n.animateSpeed):a.css({height:R-j}),I>R&&n.innerOverflow&&a.css("overflow-y","scroll"),c(O),_=.05*y,w=.9*y,u=l+x,u>w?(S=_,p.css("overflow","auto"),t.bottom_push.css({top:_+u+"px",height:_+"px",width:"1px"}),t.shadow.css({height:2*_+u+"px"})):(p.css("overflow",""),t.bottom_push.css({top:"0px",height:"0px",width:"0px"}),t.shadow.css({height:"100%"}))}h=d+m,u=l+x;var T=(b-h)/2,P=(y-u)/2;S!==!1&&(P=S),i===!0&&n.animateSpeed>0?s.animate({left:T,top:P,width:d,height:l},n.animateSpeed).css("overflow",""):s.css({left:T,top:P,width:d,height:l})}}var l=function(o){o=e(o,{}),"gallery"==o.mode&&null==o.autoScale&&(o.autoScale=!0),this.settings=t.extend({},this.defaultSettings,o),this.container=!1,this.popup=!1,this.shadow=!1,this.properties={animating:!1,isopen:!1,resizepause:!1,loaded_content:-1,bodyMarginRight:"",bodyOverflow:""}};l.prototype.adjust=function(t){t=e(t,!1);var o=this;o.properties.resizepause||t&&!o.properties.isopen||(o.properties.resizepause=!0,setTimeout(function(){d(o,t),o.properties.resizepause=!1},o.properties.updatePositionDelay),a(o))},l.prototype.checkImages=function(){this.properties.loaded_content=-1},l.prototype.close=function(){var e=this;!e.properties.animating&&e.properties.isopen&&("function"==typeof e.settings.onClose&&e.settings.onClose(e),e.properties.animating=!0,e.container.fadeOut(e.settings.fadeOutSpeed,function(){n(e,"close")}),t(window).off("resize.popbox.adjust"),e.properties.isopen=!1,e.checkImages(),"function"==typeof e.settings.afterClose&&e.settings.afterClose(e))},l.prototype.open=function(){var e=this;if(!e.properties.animating&&!e.properties.isopen){"function"==typeof e.settings.onOpen&&e.settings.onOpen(e),e.properties.animating=!0;var o=i(this.settings.close,!0)?e.settings.close:e.defaultSettings.close,s=i(this.settings.content,!0)?e.settings.content:"",p=i(this.settings.title,!0)?'<div class="popbox-title">'+e.settings.title+"</div>":"",a=i(this.settings.customClass,!0)?" "+e.settings.customClass:"",r=t("body");e.properties.bodyOverflow=r.css("overflow");var c=r.width();r.css("overflow","hidden");var d=r.width();if(d>c){e.properties.bodyMarginRight=r.css("margin-right");var l=parseInt(e.properties.bodyMarginRight),h=l+(d-c);r.css("margin-right",h+"px")}if(t(document).on("scroll.popbox touchmove.popbox mousewheel.popbox",function(t){}),r.append('<div class="popbox-container'+a+'" style="display: none;"><div class="popbox-bottom-push"></div><a class="popbox-shadow" href="javascript:void(0);"></a><div class="popbox-popup">'+p+'<a class="popbox-close">'+o+'</a><div class="popbox-content">'+s+"</div></div></div>"),e.container=t(".popbox-container"),e.popup=e.container.find(".popbox-popup"),e.shadow=e.container.find(".popbox-shadow"),e.bottom_push=e.container.find(".popbox-bottom-push"),e.close_button=e.container.find(".popbox-close"),e.title_area=e.container.find(".popbox-title"),e.content_area=e.container.find(".popbox-content"),"gallery"==e.settings.mode){e.content_area.css({visibility:"hidden",height:"0"});var u=i(this.settings.gallery.loading,!0)?e.settings.gallery.loading:e.defaultSettings.gallery.loading;e.content_area.after('<div class="popbox-gallery-loading">'+u+"</div>"),e.gallery_loading=e.container.find(".popbox-gallery-loading")}e.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)"}),e.bottom_push.css({display:"block",position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"}),e.popup.css({display:"block",position:"absolute",top:"0px",left:"0px","z-index":"993"}),e.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991",background:"#fff",opacity:"0",cursor:"default"}),e.content_area.css({overflow:"hidden",height:"100%"}),e.adjust(),e.container.fadeIn(e.settings.fadeInSpeed,function(){n(e,"open")}),e.shadow.click(function(t){e.close(),t.preventDefault()}),e.close_button.click(function(t){e.close(),t.preventDefault()}),t(window).on("resize.popbox.adjust",function(){e.adjust(!0)}),e.properties.isopen=!0,"function"==typeof e.settings.afterOpen&&e.settings.afterOpen(e)}},l.prototype.update=function(o,n){var s=this;if(o=e(o,{}),n=e(n,!0),s.settings=t.extend({},s.settings,o),s.properties.isopen){var p=i(s.settings.close,!0)?s.settings.close:s.defaultSettings.close,a=i(s.settings.content,!0)?s.settings.content:"",r=i(s.settings.title,!0)?s.settings.title:"";s.close_button.length>0&&s.close_button.html(p),s.content_area.length>0&&s.content_area.html(a),s.title_area.length>0?""!=r?s.title_area.html(r):(s.title_area.remove(),s.title_area=s.popup.find(".popbox-title")):""!=r&&(s.popup.prepend('<div class="popbox-title">'+r+"</div>"),s.title_area=s.popup.find(".popbox-title")),n&&s.adjust(!0)}},l.prototype.isOpen=function(){return 1==this.properties.isopen},l.prototype.isClose=function(){return 0==this.properties.isopen},l.prototype.defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",innerOverflow:!1,content:"",close:"X",title:"",onOpen:!1,onClose:!1,afterOpen:!1,afterClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200,autoScale:!1,customClass:"",animateSpeed:400,mode:"normal",gallery:{loading:"Loading"}},window.PopBox=l}(jQuery);