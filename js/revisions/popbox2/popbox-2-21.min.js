!function(e){function t(e,t){return"undefined"!=typeof e?e:t}function o(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function i(e,o){return o=t(o,!1),!isNaN(e-0)&&null!=e&&""!=e&&(!o||e>0)}function n(e,o){return o=t(o,!1),"string"==typeof e&&null!=e&&(!o||""!=e)}function r(e,t){var o=e.attr(t);return("undefined"==typeof o||o===!1||""===o)&&(o=""),o}function s(e,o,i,n){n=t(n,"");for(var r in o)if(o.hasOwnProperty(r))if("object"==typeof o[r])i[r]={},s(e,o[r],i[r],n+r.toLowerCase()+"-");else{var a=e.data(n+r.toLowerCase());if("undefined"!=typeof a){var p=parseFloat(a);"true"==a?a=!0:"false"==a?a=!1:p==a&&(a=p),i[r]=a}}}function a(e,t,o){if(o=o||!1,t instanceof Array)for(var i=0;i<t.length;i++)if(o){if(t[i]===e)return i}else if(t[i]==e)return i;return-1}function p(e,t){var i=r(e,"style");if(t&&i){var n=new RegExp("(^|;)\\s*"+o(t)+"\\s*:");if(i.match(n))return e.css(t)}return""}function l(e,t){if(e._properties.animating)switch(e._properties.animating=!1,t){case"close":e.container.remove(),e.container=!1,e._properties.isopen=!1,e.popup=!1,e.shadow=!1,e.$html.css({overflow:e._properties.stored_styles.htmlOverflow,height:e._properties.stored_styles.htmlHeight,"margin-right":e._properties.stored_styles.htmlMarginRight});break;case"open":e._properties.isopen=!0}}function g(e){var t=e.popup.find("img"),o=e.popup.find("iframe");t.css({"max-width":"100%",height:"auto"}),o.css({"max-height":"100%","max-width":"100%"}),e._settings.autoScale&&(t.filter(":visible").css({display:"block"}),o.css({display:"block"}))}function c(e){e=t(e,!1),e&&e.popup&&e.update({content:'<img src="'+e._properties.gallery.images[e._properties.gallery.position]+'" style="display:none;" />'})}function d(e){e=t(e,!1),e&&e.popup&&(e.gallery_next&&e.gallery_next.remove(),e.gallery_prev&&e.gallery_prev.remove(),e.gallery_next=!1,e.gallery_prev=!1)}function h(e){if(e=t(e,!1),e&&e.popup&&e._properties.gallery.images.length>1){e.popup.append('<a href="#" class="popbox-gallery-next">&nbsp;'+e._settings.gallery.next+"</a>"),e.gallery_next=e.popup.find(".popbox-gallery-next"),e.popup.append('<a href="#" class="popbox-gallery-prev">'+e._settings.gallery.prev+"&nbsp;</a>"),e.gallery_prev=e.popup.find(".popbox-gallery-prev");var o=!1,i=!1;e.gallery_next.click(function(t){t.preventDefault(),e._properties.gallery.position++,e._properties.gallery.position>=e._properties.gallery.images.length&&(e._properties.gallery.position=0),c(e)}).mousemove(function(t){o||(e.gallery_next.addClass("popbox-btn-hover"),o=!0,setTimeout(function(){o=!1},200))}).mouseleave(function(t){e.gallery_next.removeClass("popbox-btn-hover")}),e.gallery_prev.click(function(t){t.preventDefault(),e._properties.gallery.position--,e._properties.gallery.position<0&&(e._properties.gallery.position=e._properties.gallery.images.length-1),c(e)}).mousemove(function(t){i||(e.gallery_prev.addClass("popbox-btn-hover"),i=!0,setTimeout(function(){i=!1},200))}).mouseleave(function(t){e.gallery_prev.removeClass("popbox-btn-hover")})}}function u(t){var o=!1;return t.content.find("img").each(function(){var t=e(this);0!=t.width()&&0!=t.height()||this.complete!==!1||(o=!0)}),o}function f(e){var t="popbox-rsc-clone-"+(new Date).getTime(),o=e.container.clone().stop(!0,!0).addClass(t).css({display:"block",visibility:"hidden","z-index":"-1",overflow:"hidden"});o.find("iframe").attr("src",""),o.appendTo(e.$body);var i=e.$body.find("."+t);return{container:i,popup:i.find(".popbox-popup").eq(0),content:i.find(".popbox-content").eq(0),gallery_loading_area:i.find(".popbox-gallery-loading").eq(0)}}function _(e){e&&e.container&&e.container.remove()}function y(e,o){switch(o=t(o,"fixed")){case"fixed":e.container.css({position:"fixed",top:"0"});break;case"absolute":e.container.css({position:"absolute",top:e.container.offset().top})}}function m(e){e=t(e,!1),e&&e.popup&&("gallery"==e._settings.mode&&"ready"==e._properties.gallery.status&&e.content_area.find("img:hidden").fadeIn(300),e.popup.find(".popbox-btn-hover").removeClass("popbox-btn-hover"),e.$window.trigger("scroll.popbox"))}function v(e){e=t(e,!1);var o=!0;if(e&&e.popup){var n=e._settings,r=e.popup,s=e.container,a=e.content_area,p=e.shadow,l=e.gallery_loading_area;r.stop(!0,!1),s.css("overflow-y","hidden"),g(e);var c=0,d=0,h=0,y=0,v=0,w=0,x=0,b=0,S=p.width(),z=s.outerHeight(!1),k=0,C=0,$=0,T=!1,O=!1;if(!n.autoScale||"gallery"==e._settings.mode&&"ready"!=e._properties.gallery.status){k=.8*S,C=.8*z,x=r.outerWidth(!1)-r.width(),b=r.outerHeight(!1)-r.height(),c=k-x,d=C-b,O=f(e),O.popup.css({height:"auto",width:"auto",top:"0",left:"0"}),O.content.attr("style",""),O.gallery_loading_area.attr("style","");var j=a,D=O.content;"gallery"!=e._settings.mode||"ready"==e._properties.gallery.status?(O.content.css("display","block"),O.gallery_loading_area.css("display","none")):(O.content.css("display","none"),O.gallery_loading_area.css("display","block"),j=l,D=O.gallery_loading_area),i(n.width)?c=n.width:(n.scaleToContent||"ready"!=e._properties.gallery.status)&&O.popup.width()<c&&(c=O.popup.width()),i(n.maxwidth)&&c>n.maxwidth&&(c=n.maxwidth),O.popup.css({width:c}),i(n.height)?d=n.height:n.innerOverflow||(d=O.popup.height()),i(n.maxheight)&&d>n.maxheight&&(d=n.maxheight),0==parseInt(D.css("margin-top"))&&D.css({"margin-top":"-1px",top:"1px"}),u(O)&&(o=!1);var A=D.outerHeight(!0),I=A-D.height(),N=parseInt(O.popup.css("padding-top")),H=parseInt(O.popup.css("border-top-width")),P=parseInt(O.popup.css("margin-top"));isNaN(N)&&(N=0),isNaN(H)&&(H=0),isNaN(P)&&(P=0);var Z=N+H+P,M=d-(D.position().top-Z);!e._properties.newopen&&n.animateSpeed>0?j.stop(!0,!1).height(j.height()).animate({height:M-I},n.animateSpeed):j.stop(!0,!1).css({height:M-I}),A>M&&n.innerOverflow&&j.css("overflow-y","scroll"),_(O),$=.05*z,C=.9*z,y=d+b,y>C?(T=$,s.css("overflow-y","scroll"),e.bottom_push.css({top:$+y+"px",height:$+"px",width:"1px"}),e.shadow.css({height:2*$+y+"px"})):(e.bottom_push.css({top:"0px",height:"0px",width:"0px"}),e.shadow.css({height:"100%"}))}else{if(a.css({height:"100%",width:"100%",overflow:"hidden"}),O=f(e),O.popup.css({height:"auto",width:"auto",top:"auto",left:"auto"}),O.content.attr("style",""),O.content.find("img").css({"max-width":"none",height:"auto",display:"block"}),O.content.find("iframe").css({"max-height":"none","max-width":"none"}),u(O))return!1;if(v=O.popup.width(),w=O.popup.height(),x=O.popup.outerWidth(!1)-v,b=O.popup.outerHeight(!1)-w,_(O),k=.8*S-x,C=.8*z-b,k>n.maxwidth&&(k=n.maxwidth),C>n.maxheight&&(C=n.maxheight),w>C||v>k){var q=C/k,B=w/v,R=1;B>q?(R=C/w,d=C,c=v*R):(R=k/v,c=k,d=w*R)}else c=v,d=w}h=c+x,y=d+b;var L=(S-h)/2,W=(z-y)/2;T!==!1&&(W=T),!e._properties.newopen&&n.animateSpeed>0?r.animate({left:L,top:W,width:c,height:d},n.animateSpeed,function(){m(e)}).css("overflow",""):(r.css({left:L,top:W,width:c,height:d}),m(e))}return o}function w(e){e.content_area.show(),e.gallery_loading_area.hide(),e._properties.gallery.status="ready"}function x(e){if("gallery"==e._settings.mode){var t=n(e._settings.gallery.loading,!0)?e._settings.gallery.loading:e._defaultSettings.gallery.loading;e.content_area.hide(),e.gallery_loading_area.show(),e.gallery_loading_area.html(t),e._properties.gallery.status="loading"}}function b(e){if("gallery"==e._settings.mode){var t=n(e._settings.gallery.error,!0)?e._settings.gallery.error:e._defaultSettings.gallery.error;e.content_area.hide(),e.gallery_loading_area.show(),e.gallery_loading_area.html(t),e._properties.gallery.status="error",e.adjust(!0)}}function S(e){e=t(e,!1);var o=!0;if(e&&e.popup){var i=e._properties.loaded_images;if(i.length)for(var n=0;n<i.length;n++){var r=i[n];r.complete||4===r.readyState||"complete"===r.readyState||(o=!1)}}return o&&w(e),o}function z(o){if(o=t(o,!1),o&&o.popup){o._properties.loaded_images=[];var i=o.content_area.find("img");if(!(i.length>0))return!0;x(o);var n=0;if(i.each(function(t,i){if(i.src){var r=new Image;i.complete||4===i.readyState||"complete"===i.readyState?n++:("undefined"!=typeof r.onload?r.onload=function(){setTimeout(function(){S(o)&&o.adjust(!0)},10)}:"undefined"!=typeof r.onreadystatechange&&(r.onreadystatechange=function(){setTimeout(function(){S(o)&&o.adjust(!0)},10)}),"undefined"!=typeof r.onerror&&(r.onerror=function(){setTimeout(function(){e(i).remove(),b(o)},10)})),r.src=i.src,o._properties.loaded_images.push(r)}}),i.length==n)return!0}return!1}function k(e){var t=!1;return e._properties.loaded_content!==e._settings.content&&(t=z(e),e._properties.loaded_content=e._settings.content),t}function C(t){if($(t),"gallery"==t._settings.mode&&(t._settings.autoScale=!0),t.content_area.find("img").hide(),t.shadow.css({height:"100%"}),t.container.scrollTop(0),t._settings.gallery.name){var o=e("."+t._settings.gallery.name);if(o.length&&(o.each(function(){var o=e(this);if(0==o.closest(".popbox-container").length){var i=r(o,"src"),n=r(o,"href"),s=i?i:n;s&&-1==a(s,t._properties.gallery.images)&&t._properties.gallery.images.push(s)}}),t._properties.gallery.images.length>0)){var i="",n=t.content_area.find("img:first");n.length&&(i=r(n.eq(0),"src"));var s=a(i,t._properties.gallery.images);t._properties.gallery.position=0,""==i||-1==s?t._properties.gallery.images.unshift(i):s>-1&&(t._properties.gallery.position=s),h(t)}}}function $(e){e.content_area.show(),e.gallery_loading_area.hide(),e._properties.gallery.status="ready",e._properties.gallery.images=[],e._properties.gallery.position=0,d(e)}var T=function(o){o=t(o,{}),this.$window=e(window),this.$html=e("html"),this.$body=e("body"),this._settings=e.extend(!0,{},this._defaultSettings,o),this.container=!1,this.popup=!1,this.shadow=!1,this._properties={animating:!1,isopen:!1,newopen:!0,newopentime:0,retrytime:0,resizepause:!1,loaded_content:-1,loaded_images:[],stored_styles:{htmlOverflow:"",htmlHeight:"",htmlMarginRight:""},gallery:{status:"ready",images:[],position:0}}};T.prototype.adjust=function(e){e=t(e,!1);var o=this;if(o._properties.isopen&&(e||!o._properties.resizepause))if(k(o)&&w(o),o._properties.newopen)v(o),o._properties.newopen=!1;else{var n=1,r="normal";"gallery"==o._settings.mode&&"loading"==o._properties.gallery.status?(n=100,r="loading"):i(e,!0)?n=e:e||(n=o._settings.updatePositionDelay),o._properties.resizepause=!0,o._properties.resizetimer=setTimeout(function(){if("normal"==r||"loading"==r&&"error"!=o._properties.gallery.status)if(v(o))o._properties.retrytime=0;else if(o._properties.retrytime>=3e3)o._properties.retrytime=0;else{var e=100;o.adjust(e),o._properties.retrytime+=e}o._properties.resizepause=!1,o._properties.resizetimer=!1},n)}},T.prototype.refresh=function(){this._properties.loaded_content=-1,this._properties.loaded_images=[]},T.prototype.close=function(){var e=this;!e._properties.animating&&e._properties.isopen&&("function"==typeof e._settings.onClose&&e._settings.onClose(e),e._properties.animating=!0,e.container.fadeOut(e._settings.fadeOutSpeed,function(){l(e,"close")}),e.$window.off("resize.popbox scroll.popbox mousewheel.popbox"),e._properties.isopen=!1,e.refresh(),"gallery"==e._settings.mode&&e.update({content:""},!1),"function"==typeof e._settings.afterClose&&e._settings.afterClose(e))},T.prototype.open=function(){var t=this;if(t.refresh(),!t._properties.animating&&!t._properties.isopen){"function"==typeof t._settings.onOpen&&t._settings.onOpen(t),t._properties.animating=!0;var o=n(this._settings.close,!0)?t._settings.close:t._defaultSettings.close,i=n(this._settings.content,!0)?t._settings.content:"",r=n(this._settings.title,!0)?'<div class="popbox-title">'+t._settings.title+"</div>":"",s=n(this._settings.customClass,!0)?" "+t._settings.customClass:"",a=n(this._settings.gallery.loading,!0)?t._settings.gallery.loading:t._defaultSettings.gallery.loading;t._properties.stored_styles.htmlOverflow=p(t.$html,"overflow"),t._properties.stored_styles.htmlHeight=p(t.$html,"height"),t._properties.stored_styles.htmlMarginRight=p(t.$html,"margin-right");var g=t.$body.width();t.$html.css({overflow:"hidden",height:"100%"});var c=t.$body.width();c>g&&t.$html.css({"margin-right":c-g+"px"}),t.$body.append('<div class="popbox-container'+s+'" style="display: none;"><div class="popbox-bottom-push"></div><a class="popbox-shadow" href="javascript:void(0);"></a><div class="popbox-popup">'+r+'<div class="popbox-content">'+i+'</div><div class="popbox-gallery-loading">'+a+'</div><a href="#" class="popbox-close">'+o+"</a></div></div>"),t.container=e(".popbox-container"),t.popup=t.container.find(".popbox-popup"),t.shadow=t.container.find(".popbox-shadow"),t.bottom_push=t.container.find(".popbox-bottom-push"),t.close_button=t.container.find(".popbox-close"),t.title_area=t.container.find(".popbox-title"),t.content_area=t.container.find(".popbox-content"),t.gallery_loading_area=t.container.find(".popbox-gallery-loading"),t.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)","overflow-x":"hidden"}),t.bottom_push.css({display:"block",position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"}),t.popup.css({display:"block",position:"absolute",top:"0px",left:"0px","z-index":"993","-webkit-box-sizing":"content-box","-moz-box-sizing":"content-box","box-sizing":"content-box"}),t.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991",background:"#fff",opacity:"0",cursor:"default"}),t.content_area.css({overflow:"hidden",height:"auto"}),t.gallery_loading_area.css({overflow:"hidden",height:"auto"}),"gallery"==t._settings.mode&&C(t),t.container.fadeIn(t._settings.fadeInSpeed,function(){l(t,"open")}),t.shadow.click(function(e){t.close(),e.preventDefault()}),t.close_button.click(function(e){t.close(),e.preventDefault()});var d=!1,h=!1,u=0;t.$window.on("resize.popbox",function(){y(t,"fixed"),d&&(h=!0),t.adjust()}).on("scroll.popbox",function(){if(y(t,"fixed"),d)if(h)h=!1;else{t.$window.scrollTop(u);var e=0;"scroll"==t.container.css("overflow-y")?(e=t.container.scrollTop()+Math.round(d.offset().top-t.container.offset().top),e>3&&(e-=3),t.container.scrollTop(e)):(e=t.content_area.scrollTop()+Math.round(d.offset().top-t.content_area.offset().top),e>3&&(e-=3),t.content_area.scrollTop(e)),d=!1}}).on("mousewheel.popbox",function(e){}),t.container.on("focus.popbox","input,textarea,select",function(){y(t,"absolute"),d=e(this),u=t.$window.scrollTop(),setTimeout(function(){d=!1},2e3)}),t._properties.isopen=!0,t._properties.newopen=!0,t._properties.newopentime=(new Date).getTime(),t.adjust(),"function"==typeof t._settings.afterOpen&&t._settings.afterOpen(t)}},T.prototype.update=function(o,i){var r=this;if(o=t(o,{}),i=t(i,!0),r._settings=e.extend(!0,{},r._settings,o),r._properties.isopen){var s=n(r._settings.close,!0)?r._settings.close:r._defaultSettings.close,a=n(r._settings.content,!0)?r._settings.content:"",p=n(r._settings.title,!0)?r._settings.title:"";r.close_button.length>0&&r.close_button.html(s),r.content_area.length>0&&r.content_area.html(a),r.title_area.length>0?""!=p?r.title_area.html(p):(r.title_area.remove(),r.title_area=r.popup.find(".popbox-title")):""!=p&&(r.popup.prepend('<div class="popbox-title">'+p+"</div>"),r.title_area=r.popup.find(".popbox-title")),"gallery"==r._settings.mode?C(r):$(r),i?r.adjust(!0):g(r)}},T.prototype.isOpen=function(){return 1==this._properties.isopen},T.prototype.isClose=function(){return 0==this._properties.isopen},T.prototype.applyDataSettings=function(e){e&&e.length&&s(e,T.prototype._defaultSettings,this._settings)},T.prototype._defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",innerOverflow:!1,scaleToContent:!1,content:"",close:"X",title:"",onOpen:!1,onClose:!1,afterOpen:!1,afterClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200,autoScale:!1,autoSetup:!0,customClass:"",href:"",animateSpeed:400,mode:"normal",gallery:{loading:'<div style="padding:10px;">Loading...</div>',error:'<div style="padding:10px;">There was an error loading the image.</div>',name:"",next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>"}},e.fn.PopBox=function(t){var o=e(this);o.length&&o.each(function(){var o=e(this),i=new T(t);o.click(function(n){n.preventDefault();var a=e.extend(!0,{},t);s(o,T.prototype._defaultSettings,a);var p=a.href||r(o,"href"),l=a.autoSetup,g={},c=!1;if(p&&(null==l||1===l||l===!0||"1"===l||"true"===l)){var d={youtube:[/^(?:http:|https:)?\/\/(?:www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_\-]+)/,/^(?:http:|https:)?\/\/youtu.be\/([a-zA-Z0-9_\-]+)/,/^(?:http:|https:)?\/\/(?:www\.)?youtube\.com\/embed\/([a-zA-Z0-9_\-]+)/],vimeo:[/^(?:http:|https:)?\/\/(?:www\.)?vimeo\.com\/([a-zA-Z0-9_\-]+)/,/^(?:http:|https:)?\/\/player\.vimeo\.com\/video\/([a-zA-Z0-9_\-]+)/],image:[/^(?:http:|https:)?\/\/[a-zA-Z0-9_\-\./]+(?:\.jpg|\.png|\.gif)(?:.+)?/,/^[a-zA-Z0-9_\-\./]+(?:\.jpg|\.png|\.gif)(?:.+)?/]};e:for(var h in d)if(d.hasOwnProperty(h)&&d[h]instanceof Array)for(var u=0;u<d[h].length;u++){var f=p.match(d[h][u]);if(f){switch(h){case"youtube":g.content='<iframe width="1280" height="720" src="//www.youtube.com/embed/'+f[1]+'" frameborder="0" allowfullscreen></iframe>',g.autoScale=!0;break;case"vimeo":g.content='<iframe width="1280" height="720" src="//player.vimeo.com/video/'+f[1]+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',g.autoScale=!0;break;case"image":g.content='<img src="'+f[0]+'" alt="" />',g.mode="gallery"}e.extend(!0,g,a),c=!0;break e}}}i=new T(c?g:a),i.open()})})},e(".popbox").PopBox(),window.PopBox=T}(jQuery);