!function(t){function e(t,e){return"undefined"!=typeof t?t:e}function o(t,o){return o=e(o,!1),!isNaN(t-0)&&null!=t&&""!=t&&(!o||t>0)}function i(t,o){return o=e(o,!1),"string"==typeof t&&null!=t&&(!o||""!=t)}function s(t,e){if(t.properties.animating)switch(t.properties.animating=!1,e){case"close":t.container.remove(),t.properties.isopen=!1,t.container=!1,t.popup=!1,t.shadow=!1;break;case"open":t.properties.isopen=!0}}function n(e,i){var s={forceAbsolute:!1,container:window,completeHandler:null,animate:!0,width:"auto",height:"auto",maxwidth:"none",maxheight:"none",push_obj:!1,shadow:!1};t.extend(s,i),e.each(function(i){var n=t(this),p=t(s.container),a=s.container==window;s.forceAbsolute&&(a?n.remove().appendTo("body"):n.remove().appendTo(p.get(0)));var r={position:n.css("position"),visibility:n.css("visibility"),display:n.css("display")},c={visibility:p.css("visibility"),display:p.css("display")},h={position:"absolute",visibility:"hidden",display:"block"},d={visibility:"hidden",display:"block"};n.css(h),a||p.css(d);var l=.8*(a?p.width():p.outerWidth(!1)),u=n.outerWidth(!1)-n.width(),f=l-u;o(s.width)?n.width(s.width):o(s.maxwidth)&&f>s.maxwidth?n.width(s.maxwidth):n.width(f),o(s.height)&&n.height(s.height);var g=.05*(a?p.height():p.outerHeight(!1)),b=a?p.height():p.outerHeight(!1),w=.9*b,x=n.outerHeight(!1),v=!1;x>w?(v=g,p.css("overflow","auto"),s.push_obj.css({top:g+x+"px",height:g+"px",width:"1px"}),s.shadow.css({height:2*g+x+"px"})):(p.css("overflow",""),s.push_obj.css({top:"0px",height:"0px",width:"0px"}),s.shadow.css({height:"100%"}));var m=((a?p.width():p.outerWidth(!1))-n.outerWidth(!1))/2,y=((a?p.height():p.outerHeight(!1))-n.outerHeight(!1))/2;v!==!1&&(y=v),a&&(m+=p.scrollLeft(),y+=p.scrollTop()),n.css(r),a||p.css(c),s.animate===!0?n.stop(!0,!0).animate({left:m,top:y},500):n.stop(!0,!0).css({left:m,top:y}),s.completeHandler&&s.completeHandler(e)})}function p(t,o){t=e(t,!1),o=e(o,!1);var i=!0;if(t&&t.popup){var s=t.popup.find("img");s.length>0&&s.each(function(t,e){e.complete||(i=!1)})}return o&&i&&c(t,!0),i}function a(o){if(o=e(o,!1),o&&o.popup){var i=o.popup.find("img");if(i.length>0){var s=0;i.each(function(e,i){i.complete?s++:t(i).load(function(){p(o,!0)})}),i.length==s&&p(o,!0)}}}function r(t){t.properties.loaded_content!==t.settings.content&&(p(t)||a(t),t.properties.loaded_content=t.settings.content)}function c(t,o){o=e(o,!1),t=e(t,!1),t&&n(t.popup,{animate:o,container:t.container,width:t.settings.width,height:t.settings.height,maxwidth:t.settings.maxwidth,maxheight:t.settings.maxheight,push_obj:t.bottom_push,shadow:t.shadow})}var h=function(o){o=e(o,{}),this.settings=t.extend({},this.defaultSettings,o),this.container=!1,this.shadow=!1,this.properties={animating:!1,isopen:!1,resizepause:!1,loaded_content:-1}};h.prototype.adjust=function(t){t=e(t,!1);var o=this;o.properties.resizepause||t&&!o.properties.isopen||(o.properties.resizepause=!0,setTimeout(function(){c(o,t),o.properties.resizepause=!1},o.properties.updatePositionDelay),r(o))},h.prototype.checkImages=function(){this.properties.loaded_content=-1},h.prototype.close=function(){var e=this;!e.properties.animating&&e.properties.isopen&&("function"==typeof e.settings.beforeClose&&e.settings.beforeClose(e),e.properties.animating=!0,e.container.fadeOut(e.settings.fadeOutSpeed,function(){s(e,"close"),t("body").css({overflow:"","margin-right":""})}),t(window).off("resize.popbox.adjust"),e.properties.isopen=!1,"function"==typeof e.settings.onClose&&e.settings.onClose(e))},h.prototype.open=function(){var e=this;if(!e.properties.animating&&!e.properties.isopen){"function"==typeof e.settings.beforeOpen&&e.settings.beforeOpen(e),e.properties.animating=!0;var o=i(this.settings.close,!0)?e.settings.close:this.defaultSettings.close,n=i(this.settings.content,!0)?e.settings.content:"",p=t("body"),a=p.width();p.css("overflow","hidden");var r=p.width();if(r>a){var c=parseInt(p.css("margin-right")),h=c+(r-a);p.css("margin-right",h+"px")}p.append('<div class="popbox-container" style="display: none;"><div class="popbox-bottom-push"></div><a class="popbox-shadow" href="javascript:void(0);"></a><div class="popbox-popup"><a class="popbox-close">'+o+"</a>"+n+"</div></div>"),e.container=t(".popbox-container"),e.popup=e.container.find(".popbox-popup"),e.shadow=e.container.find(".popbox-shadow"),e.bottom_push=e.container.find(".popbox-bottom-push"),e.close_button=e.container.find(".popbox-close"),e.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)"}),e.bottom_push.css({display:"block",position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"}),e.popup.css({display:"block",visibility:"visible",position:"absolute",top:"0px",left:"0px","z-index":"993"}),e.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991",background:"#fff",opacity:"0",filter:"alpha(opacity=0)",cursor:"default"}),e.adjust(),e.container.fadeIn(e.settings.fadeInSpeed,function(){s(e,"open")}),e.shadow.click(function(t){e.close(),t.preventDefault()}),e.close_button.click(function(t){e.close(),t.preventDefault()}),t(window).on("resize.popbox.adjust",function(){e.adjust(!0)}),e.properties.isopen=!0,"function"==typeof e.settings.onOpen&&e.settings.onOpen(e)}},h.prototype.setSettings=function(o,s){var n=this,p=!1;if(o=e(o,{}),s=e(s,!0),e(o.content,!1)!==!1&&o.content!=n.settings.content&&(p=!0),n.settings=t.extend({},n.settings,o),n.properties.isopen){if(p){var a=i(this.settings.close,!0)?n.settings.close:this.defaultSettings.close,r=i(this.settings.content,!0)?n.settings.content:"";n.popup.html('<a class="popbox-close">'+a+"</a>"+r),n.close_button=n.popup.find(".popbox-close"),n.close_button.click(function(t){n.close(),t.preventDefault()})}s&&n.adjust(!0)}},h.prototype.isOpen=function(){return 1==this.properties.isopen},h.prototype.isClose=function(){return 0==this.properties.isopen},h.prototype.defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",content:"",close:"X",onOpen:!1,onClose:!1,beforeOpen:!1,beforeClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200},window.PopBox=h}(jQuery);