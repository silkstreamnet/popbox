(function(p){function l(a,b){return"undefined"!==typeof a?a:b}function w(a,b){b=l(b,!1);return!isNaN(a-0)&&null!=a&&""!=a&&(!b||0<a)}function k(a,b){b=l(b,!1);return"string"===typeof a&&null!=a&&(!b||""!=a)}function s(a,b){var c=a.attr(b);if("undefined"===typeof c||!1===c||""===c)c="";return c}function y(a,b,c){c=c||!1;if(b instanceof Array)for(var e=0;e<b.length;e++)if(c){if(b[e]===a)return e}else if(b[e]==a)return e;return-1}function t(a,b){var c=s(a,"style");if(b&&c){var e=new RegExp("(^|;)\\s*"+
RegExp.escape(b)+"\\s*:");if(c.match(e))return a.css(b)}return""}function z(a,b){if(a._properties.animating)switch(a._properties.animating=!1,b){case "close":a.container.remove();a.container=!1;a._properties.isopen=!1;a.popup=!1;a.shadow=!1;a.$html.css({overflow:a._properties.stored_styles.htmlOverflow,height:a._properties.stored_styles.htmlHeight,"margin-right":a._properties.stored_styles.htmlMarginRight});break;case "open":a._properties.isopen=!0}}function A(a){a.popup.find("img").css({"max-width":"100%",
height:"auto"}).filter(":visible").css({display:"block"});a.popup.find("iframe").css({"max-height":"100%","max-width":"100%"})}function B(a){(a=l(a,!1))&&a.popup&&a.update({content:'<img src="'+a._properties.gallery.images[a._properties.gallery.position]+'" style="display:none;" />'})}function J(a){if((a=l(a,!1))&&a.popup&&1<a._properties.gallery.images.length){a.popup.append('<a href="#" class="popbox-gallery-next">&nbsp;'+a._settings.gallery.next+"</a>");a.gallery_next=a.popup.find(".popbox-gallery-next");
a.popup.append('<a href="#" class="popbox-gallery-prev">'+a._settings.gallery.prev+"&nbsp;</a>");a.gallery_prev=a.popup.find(".popbox-gallery-prev");var b=!1,c=!1;a.gallery_next.click(function(b){b.preventDefault();a._properties.gallery.position++;a._properties.gallery.position>=a._properties.gallery.images.length&&(a._properties.gallery.position=0);B(a)}).mousemove(function(c){b||(a.gallery_next.addClass("popbox-btn-hover"),b=!0,setTimeout(function(){b=!1},200))}).mouseleave(function(b){a.gallery_next.removeClass("popbox-btn-hover")});
a.gallery_prev.click(function(b){b.preventDefault();a._properties.gallery.position--;0>a._properties.gallery.position&&(a._properties.gallery.position=a._properties.gallery.images.length-1);B(a)}).mousemove(function(b){c||(a.gallery_prev.addClass("popbox-btn-hover"),c=!0,setTimeout(function(){c=!1},200))}).mouseleave(function(b){a.gallery_prev.removeClass("popbox-btn-hover")})}}function C(a){var b=a.container.clone().stop(!0,!0).addClass("popbox-rsc-clone").css({display:"block",visibility:"hidden",
"z-index":"-1",overflow:"hidden"});b.find("iframe").attr("src","");b.appendTo(a.$body);a=a.$body.find(".popbox-rsc-clone");return{container:a,popup:a.find(".popbox-popup").eq(0),content:a.find(".popbox-content").eq(0),gallery_loading_area:a.find(".popbox-gallery-loading").eq(0)}}function D(a){(a=l(a,!1))&&a.popup&&("gallery"==a._settings.mode&&"ready"==a._properties.gallery.status&&a.content_area.find("img:hidden").fadeIn(300),a.popup.find(".popbox-btn-hover").removeClass("popbox-btn-hover"))}function E(a){if((a=
l(a,!1))&&a.popup){var b=a._settings,c=a.popup,e=a.container,f=a.content_area,m=a.shadow,x=a.gallery_loading_area;c.stop(!0,!1);e.css("overflow-y","hidden");A(a);var n=0,h=0,d=0,g=0,k=0,p=0,r=0,q=m.width(),u=e.outerHeight(!1),g=d=h=0,d=m=!1;if(b.autoScale&&"ready"==a._properties.gallery.status)f.css({height:"100%",width:"100%",overflow:"hidden"}),d=C(a),d.popup.css({height:"auto",width:"auto",top:"auto",left:"auto"}),d.content.attr("style",""),d.content.find("img").css({"max-width":"none",height:"auto",
display:"block"}),d.content.find("iframe").css({"max-height":"none","max-width":"none"}),g=d.popup.width(),k=d.popup.height(),p=d.popup.outerWidth(!1)-g,r=d.popup.outerHeight(!1)-k,d&&d.container&&d.container.remove(),h=.8*q-p,d=.8*u-r,h>b.maxwidth&&(h=b.maxwidth),d>b.maxheight&&(d=b.maxheight),k>d||g>h?k/g>d/h?(h=d,n=d/k*g):(n=h,h=h/g*k):(n=g,h=k);else{h=.8*q;d=.8*u;p=c.outerWidth(!1)-c.width();r=c.outerHeight(!1)-c.height();n=h-p;h=d-r;d=C(a);d.popup.css({height:"auto",width:"auto",top:"0",left:"0"});
d.content.attr("style","");d.gallery_loading_area.attr("style","");g=d.content;"ready"==a._properties.gallery.status?(d.content.css("display","block"),d.gallery_loading_area.css("display","none")):(d.content.css("display","none"),d.gallery_loading_area.css("display","block"),f=x,g=d.gallery_loading_area);w(b.width)?n=b.width:(b.scaleToContent||"ready"!=a._properties.gallery.status)&&d.popup.width()<n&&(n=d.popup.width());w(b.maxwidth)&&n>b.maxwidth&&(n=b.maxwidth);d.popup.css({width:n});w(b.height)?
h=b.height:b.innerOverflow||(h=d.popup.height());w(b.maxheight)&&h>b.maxheight&&(h=b.maxheight);0==parseInt(g.css("margin-top"))&&g.css({"margin-top":"-1px",top:"1px"});var x=g.outerHeight(!0),k=x-g.height(),v=parseInt(d.popup.css("padding-top")),s=parseInt(d.popup.css("border-top-width")),t=parseInt(d.popup.css("margin-top"));isNaN(v)&&(v=0);isNaN(s)&&(s=0);isNaN(t)&&(t=0);v=v+s+t;g=h-(g.position().top-v);!a._properties.newopen&&0<b.animateSpeed?f.stop(!0,!1).height(f.height()).animate({height:g-
k},b.animateSpeed):f.stop(!0,!1).css({height:g-k});x>g&&b.innerOverflow&&f.css("overflow-y","scroll");d&&d.container&&d.container.remove();g=.05*u;d=h+r;d>.9*u?(m=g,e.css("overflow-y","scroll"),a.bottom_push.css({top:g+d+"px",height:g+"px",width:"1px"}),a.shadow.css({height:2*g+d+"px"})):(a.bottom_push.css({top:"0px",height:"0px",width:"0px"}),a.shadow.css({height:"100%"}))}e=(q-(n+p))/2;r=(u-(h+r))/2;!1!==m&&(r=m);!a._properties.newopen&&0<b.animateSpeed?c.animate({left:e,top:r,width:n,height:h},
b.animateSpeed,function(){D(a)}).css("overflow",""):(c.css({left:e,top:r,width:n,height:h}),D(a))}}function F(a){"gallery"==a._settings.mode&&(a.content_area.show(),a.gallery_loading_area.hide(),a._properties.gallery.status="ready")}function K(a){if("gallery"==a._settings.mode){var b=k(a._settings.gallery.loading,!0)?a._settings.gallery.loading:a._defaultSettings.gallery.loading;a.content_area.hide();a.gallery_loading_area.show();a.gallery_loading_area.html(b);a._properties.gallery.status="loading"}}
function G(a){a=l(a,!1);var b=!0;if(a&&a.popup){var c=a._properties.loaded_images;if(c.length)for(var e=0;e<c.length;e++){var f=c[e];f.complete||4===f.readyState||"complete"===f.readyState||(b=!1)}}b&&F(a);return b}function L(a){if((a=l(a,!1))&&a.popup){a._properties.loaded_images=[];var b=a.popup.find("img");if(0<b.length){K(a);var c=0;b.each(function(b,f){if(f.src){var m=new Image;f.complete||4===f.readyState||"complete"===f.readyState?c++:("undefined"!==typeof m.onload?m.onload=function(){setTimeout(function(){G(a)&&
a.adjust(!0)},10)}:"undefined"!==typeof m.onreadystatechange&&(m.onreadystatechange=function(){setTimeout(function(){G(a)&&a.adjust(!0)},10)}),"undefined"!==typeof m.onerror&&(m.onerror=function(){p(f).remove();var b=a;if("gallery"==b._settings.mode){var c=k(b._settings.gallery.error,!0)?b._settings.gallery.error:b._defaultSettings.gallery.error;b.content_area.hide();b.gallery_loading_area.show();b.gallery_loading_area.html(c);b._properties.gallery.status="error";b.adjust(!0)}}));m.src=f.src;a._properties.loaded_images.push(m)}});
if(b.length==c)return!0}else return!0}return!1}function M(a){var b=!1;a._properties.loaded_content!==a._settings.content&&(b=L(a),a._properties.loaded_content=a._settings.content);return b}function H(a){I(a);"gallery"==a._settings.mode&&(a._settings.autoScale=!0);a.content_area.find("img").hide();if(a._settings.gallery.name){var b=p("."+a._settings.gallery.name);if(b.length&&(b.each(function(){var b=p(this);if(0==b.closest(".popbox-container").length){var c=s(b,"src"),b=s(b,"href");(c=c?c:b)&&-1==
y(c,a._properties.gallery.images)&&a._properties.gallery.images.push(c)}}),0<a._properties.gallery.images.length)){var b="",c=a.content_area.find("img:first");c.length&&(b=s(c.eq(0),"src"));c=y(b,a._properties.gallery.images);a._properties.gallery.position=0;""==b||-1==c?a._properties.gallery.images.unshift(b):-1<c&&(a._properties.gallery.position=c);J(a)}}}function I(a){a.content_area.show();a.gallery_loading_area.hide();a._properties.gallery.status="ready";a._properties.gallery.images=[];a._properties.gallery.position=
0;(a=l(a,!1))&&a.popup&&(a.gallery_next&&a.gallery_next.remove(),a.gallery_prev&&a.gallery_prev.remove(),a.gallery_next=!1,a.gallery_prev=!1)}null!=RegExp&&null==RegExp.escape&&(RegExp.escape=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")});var q=function(a){a=l(a,{});this.$window=p(window);this.$html=p("html");this.$body=p("body");this._settings=p.extend(!0,{},this._defaultSettings,a);this.shadow=this.popup=this.container=!1;this._properties={animating:!1,isopen:!1,newopen:!0,newopentime:0,
resizepause:!1,loaded_content:-1,loaded_images:[],stored_styles:{htmlOverflow:"",htmlHeight:"",htmlMarginRight:""},gallery:{status:"ready",images:[],position:0}}};q.prototype.adjust=function(a){a=l(a,!1);var b=this;if(b._properties.isopen&&(a||!b._properties.resizepause))if(M(b)&&F(b),b._properties.newopen)E(b),b._properties.newopen=!1;else{var c=1,e="normal";"gallery"==b._settings.mode&&"loading"==b._properties.gallery.status?(c=100,e="loading"):a||(c=b._settings.updatePositionDelay);b._properties.resizepause=
!0;b._properties.resizetimer=setTimeout(function(){if("normal"==e||"loading"==e&&"error"!=b._properties.gallery.status)E(b),b._properties.resizepause=!1,b._properties.resizetimer=!1},c)}};q.prototype.refresh=function(){this._properties.loaded_content=-1;this._properties.loaded_images=[]};q.prototype.close=function(){var a=this;if(!a._properties.animating&&a._properties.isopen){if("function"===typeof a._settings.onClose)a._settings.onClose(a);a._properties.animating=!0;a.container.fadeOut(a._settings.fadeOutSpeed,
function(){z(a,"close")});a.$window.off("resize.popbox.adjust");a._properties.isopen=!1;a.refresh();"gallery"==a._settings.mode&&a.update({content:""},!1);"function"===typeof a._settings.afterClose&&a._settings.afterClose(a)}};q.prototype.open=function(){var a=this;a.refresh();if(!a._properties.animating&&!a._properties.isopen){if("function"===typeof a._settings.onOpen)a._settings.onOpen(a);a._properties.animating=!0;var b=k(this._settings.close,!0)?a._settings.close:a._defaultSettings.close,c=k(this._settings.content,
!0)?a._settings.content:"",e=k(this._settings.title,!0)?'<div class="popbox-title">'+a._settings.title+"</div>":"",f=k(this._settings.customClass,!0)?" "+a._settings.customClass:"",m=k(this._settings.gallery.loading,!0)?a._settings.gallery.loading:a._defaultSettings.gallery.loading;a._properties.stored_styles.htmlOverflow=t(a.$html,"overflow");a._properties.stored_styles.htmlHeight=t(a.$html,"height");a._properties.stored_styles.htmlMarginRight=t(a.$html,"margin-right");var l=a.$body.width();a.$html.css({overflow:"hidden",
height:"100%"});var n=a.$body.width();n>l&&a.$html.css({"margin-right":n-l+"px"});a.$body.append('<div class="popbox-container'+f+'" style="display: none;"><div class="popbox-bottom-push"></div><a class="popbox-shadow" href="javascript:void(0);"></a><div class="popbox-popup">'+e+'<div class="popbox-content">'+c+'</div><div class="popbox-gallery-loading">'+m+'</div><a href="#" class="popbox-close">'+b+"</a></div></div>");a.container=p(".popbox-container");a.popup=a.container.find(".popbox-popup");
a.shadow=a.container.find(".popbox-shadow");a.bottom_push=a.container.find(".popbox-bottom-push");a.close_button=a.container.find(".popbox-close");a.title_area=a.container.find(".popbox-title");a.content_area=a.container.find(".popbox-content");a.gallery_loading_area=a.container.find(".popbox-gallery-loading");a.container.css({display:"none",height:"100%",width:"100%",position:"fixed",left:"0px",top:"0px","z-index":"990","background-color":"rgba(0,0,0,0.4)","overflow-x":"hidden"});a.bottom_push.css({display:"block",
position:"absolute",left:"0px",top:"0px",height:"0px",width:"1px","z-index":"992"});a.popup.css({display:"block",position:"absolute",top:"0px",left:"0px","z-index":"993","-webkit-box-sizing":"content-box","-moz-box-sizing":"content-box","box-sizing":"content-box"});a.shadow.css({display:"block",position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"991",background:"#fff",opacity:"0",cursor:"default"});a.content_area.css({overflow:"hidden",height:"auto"});a.gallery_loading_area.css({overflow:"hidden",
height:"auto"});"gallery"==a._settings.mode&&H(a);a.container.fadeIn(a._settings.fadeInSpeed,function(){z(a,"open")});a.shadow.click(function(b){a.close();b.preventDefault()});a.close_button.click(function(b){a.close();b.preventDefault()});a.$window.on("resize.popbox.adjust",function(){a.adjust()});a._properties.isopen=!0;a._properties.newopen=!0;a._properties.newopentime=(new Date).getTime();a.adjust();"function"===typeof a._settings.afterOpen&&a._settings.afterOpen(a)}};q.prototype.update=function(a,
b){a=l(a,{});b=l(b,!0);this._settings=p.extend(!0,{},this._settings,a);if(this._properties.isopen){var c=k(this._settings.close,!0)?this._settings.close:this._defaultSettings.close,e=k(this._settings.content,!0)?this._settings.content:"",f=k(this._settings.title,!0)?this._settings.title:"";0<this.close_button.length&&this.close_button.html(c);0<this.content_area.length&&this.content_area.html(e);0<this.title_area.length?""!=f?this.title_area.html(f):(this.title_area.remove(),this.title_area=this.popup.find(".popbox-title")):
""!=f&&(this.popup.prepend('<div class="popbox-title">'+f+"</div>"),this.title_area=this.popup.find(".popbox-title"));"gallery"==this._settings.mode?H(this):I(this);b?this.adjust(!0):A(this)}};q.prototype.isOpen=function(){return!0==this._properties.isopen};q.prototype.isClose=function(){return!1==this._properties.isopen};q.prototype._defaultSettings={width:"auto",height:"auto",maxwidth:"none",maxheight:"none",innerOverflow:!1,scaleToContent:!1,content:"",close:"X",title:"",onOpen:!1,onClose:!1,afterOpen:!1,
afterClose:!1,fadeInSpeed:400,fadeOutSpeed:400,updatePositionDelay:200,autoScale:!1,customClass:"",animateSpeed:400,mode:"normal",gallery:{loading:'<div style="padding:10px;">Loading...</div>',error:'<div style="padding:10px;">There was an error loading the image.</div>',name:"",next:"<span>&#x25B6;</span>",prev:"<span>&#x25C0;</span>"}};window.PopBox=q})(jQuery);
